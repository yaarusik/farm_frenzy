(()=>{"use strict";const t=class{constructor(t,e="div",i="",s=""){const n=document.createElement(e);n.className=i,n.textContent=s,t&&t.append(n),this.node=n}destroy(){this.node.remove()}},e=class{devideButton(t){let e=t.textContent;for(t.textContent="";e.length>0;){const i=document.createElement("span");i.textContent=e[0],i.classList.add("btn__letter"),t.append(i),e=e.slice(1,e.length)}}};let i="50";const s=new Audio("audio/front_music/start.mp3");s.volume=0;const n=new Audio("audio/front_music/main.mp3");n.volume=0;class a{constructor(){this.startMusicPlay=this.startMusicPlay.bind(this)}changeMusicVolume(t){i=t,s.volume=+t/100,n.volume=+t/100}start(){window.addEventListener("click",this.startMusicPlay)}startMusicPlay(){window.removeEventListener("click",this.startMusicPlay),n.paused&&(n.pause(),n.currentTime=0,s.play(),s.addEventListener("ended",this.onMain))}onStart(){n.pause(),n.currentTime=0,s.currentTime=0,s.play()}onMain(){s.pause(),s.currentTime=0,n.currentTime=0,n.loop=!0,n.play()}}class o extends t{constructor(i,s,n){super(i,s,n),this.buttonEffect=new e,this.resizeWindow=()=>{this.wrapper.node.style.width=String(window.innerHeight/600*800)+"px"},this.wrapper=new t(this.node,"div","wrapper main",""),this.resizeWindow(),window.addEventListener("resize",this.resizeWindow),this.music=new a,new t(this.wrapper.node,"img","logo","").node.src="images/main/logo-ru.png";const o=new t(this.wrapper.node,"div","panel","");new t(o.node,"div","title panel__greet","Здравствуйте!").node.setAttribute("data-text","Здравствуйте!");const h=new t(o.node,"input","panel__name","");h.node.type="text",h.node.readOnly=!0;const r=new t(o.node,"button","btn","Карьера");this.buttonEffect.devideButton(r.node),r.node.onclick=()=>{this.onSelectMap(),this.music.onMain()};const c=new t(o.node,"button","btn","Авторизация");this.buttonEffect.devideButton(c.node),c.node.onclick=()=>{this.onLogin()};const d=new t(this.wrapper.node,"footer","footer",""),l=new t(d.node,"button","btn","Настройки");this.buttonEffect.devideButton(l.node),l.node.onclick=()=>{this.onSettings()};const g=new t(d.node,"button","btn","Награды");this.buttonEffect.devideButton(g.node),g.node.onclick=()=>{this.onAwards()};const m=new t(d.node,"button","btn","Авторы");this.buttonEffect.devideButton(m.node),m.node.onclick=()=>{this.onAuthors()}}onSettings(){throw new Error("Method not implemented.")}onAwards(){throw new Error("Method not implemented.")}onAuthors(){throw new Error("Method not implemented.")}onSelectMap(){throw new Error("Method not implemented.")}onLogin(){throw new Error("Method not implemented.")}}const h=[{type:"picture",name:"карта",image:"images/map/gameMapComplete.jpg",x:0,y:0,width:1600,height:1200,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"меню__бар",image:"images/map/map__menu.png",x:0,y:1092,width:1600,height:110,sx:0,sy:0,swidth:0,sheight:0},{type:"button",name:"Магазин",image:"images/map/menuButtons.png",stepY:44,x:16,y:1112,width:148,height:68,sx:0,sy:0,swidth:80,sheight:41},{type:"button",name:"Меню",image:"images/map/menuButtons.png",stepY:44,x:1456,y:1112,width:136,height:66,sx:0,sy:0,swidth:80,sheight:41},{type:"button",name:"1",image:"images/map/new__level.png",id:1,x:560,y:928,width:76,height:76,sx:0,sy:0,stepY:76,swidth:76,sheight:76},{type:"button",name:"2",image:"images/map/new__level.png",id:2,x:635,y:997,width:76,height:76,sx:0,sy:0,stepY:76,swidth:76,sheight:76},{type:"button",name:"3",image:"images/map/new__level.png",id:3,x:716,y:1068,width:76,height:76,sx:0,sy:0,stepY:76,swidth:76,sheight:76}],r=[{text:"Магазин",fontSize:"24px Vag_Rounded-Bold CY",color:"#fff",x:42,y:1153,animation:!1},{text:"Меню",fontSize:"24px Vag_Rounded-Bold CY",color:"#fff",x:1492,y:1151,animation:!1}];class c{constructor(t,e,i,s,n){this.xpoint=e,this.ypoint=i,this.width=s,this.height=n,this.picture=t}draw(t){t.drawImage(this.picture,this.xpoint,this.ypoint,this.width,this.height)}}class d extends c{constructor(t,e,i,s,n,a,o,h,r){super(t,a,o,h,r),this.sxpoint=e,this.sypoint=i,this.swidth=s,this.sheight=n}draw(t){t.drawImage(this.picture,this.sxpoint,this.sypoint,this.swidth,this.sheight,this.xpoint,this.ypoint,this.width,this.height)}}class l{constructor(t,e){this.canvas=t,this.context=e,this.initialWidth=1600,this.initialHeight=1200}loadImage(t){return new Promise((e=>{const i=new Image;i.src=t,i.onload=()=>{e(i)}}))}renderImages(t){return e=this,i=void 0,n=function*(){const e=[];return yield Promise.all(t).then((t=>t.forEach((t=>e.push(t))))),e},new((s=void 0)||(s=Promise))((function(t,a){function o(t){try{r(n.next(t))}catch(t){a(t)}}function h(t){try{r(n.throw(t))}catch(t){a(t)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(o,h)}r((n=n.apply(e,i||[])).next())}));var e,i,s,n}drawImage(t,e){t.forEach(((t,i)=>{const s=e[i];"button"===s.type||"animation"===s.type?new d(t,s.sx,s.sy,s.swidth,s.sheight,s.x,s.y,s.width,s.height).draw(this.context):new c(t,s.x,s.y,s.width,s.height).draw(this.context)}))}drawText(t){t.forEach((t=>{if(this.context.fillStyle=t.color,this.context.font=t.fontSize,t.animation){const e=t.y,i=t.x;for(let i=0;i<t.text.length;i++){const s=this.context.measureText(t.text[i]);t.x+=Math.floor(s.width)+.7,t.y=i%2?e-3:e+3,this.context.textAlign="right",this.context.fillText(t.text[i],t.x,t.y)}t.x=i,t.y=e}else this.context.textAlign="start",this.context.fillText(t.text,t.x,t.y)}))}canvasScale(){const t=getComputedStyle(this.canvas).width,e=getComputedStyle(this.canvas).height;return{curWidthK:this.initialWidth/parseInt(t,10),curHeightK:this.initialHeight/parseInt(e,10)}}determineCoords(t,e){const i=this.canvas.getBoundingClientRect(),s=t.clientX-i.left,n=t.clientY-i.top,{currentX:a,currentW:o,currentY:h,currentH:r}=e;return s>=a&&s<a+o&&n>=h&&n<h+r}scaleCoords(t,e,i){return{currentX:t.x/e,currentW:t.width/e,currentY:t.y/i,currentH:t.height/i}}buttonsClick(t,e,i){t.sy=e*i}buttonsHover(t,e,i){t.sy=e*i}btnDisable(t,e){t.sy=3*e}btnActive(t,e){t.sy=0}changeAnimation(t,e,i){i.forEach((i=>{i.text===t.name&&(i.animation=e)}))}objParse(t){return JSON.parse(JSON.stringify(t))}opacityShow(t){t.opacity<=1?t.opacity+=.04:t.show=!1,this.context.globalAlpha=t.opacity}opacityDisable(t){t.opacity>=0&&(t.opacity-=.04),this.context.globalAlpha=t.opacity}canvasFilters(t){this.context.shadowBlur=t,this.context.shadowOffsetX=t,this.context.shadowOffsetY=t}}var g=function(t,e,i,s){return new(i||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}))};class m extends t{constructor(e,i="div",s="",n=""){super(e,i,s,n),this.music=new a,this.textOptions=JSON.parse(JSON.stringify(r)),this.imagesOptions=JSON.parse(JSON.stringify(h)),this.buttons=this.imagesOptions.filter((t=>"button"===t.type)),this.curWidthK=1,this.curHeightK=1,this.animation=0;const o=new t(this.node,"div","canvas__container","");this.canvas=new t(o.node,"canvas","canvas",""),this.canvas.node.width=1600,this.canvas.node.height=1200,this.context=this.canvas.node.getContext("2d"),this.commonFunction=new l(this.canvas.node,this.context),this.startMap(),window.onresize=()=>{const t=this.commonFunction.canvasScale();this.curWidthK=t.curWidthK,this.curHeightK=t.curHeightK},this.canvas.node.addEventListener("mousemove",(t=>{this.canvasMoveHundler(t,this.canvas.node,this.buttons)})),this.canvas.node.addEventListener("click",(t=>{this.canvasClickHundler(t,this.canvas.node,this.buttons)}))}startMap(){return g(this,void 0,void 0,(function*(){const t=this.imagesOptions.map((t=>this.commonFunction.loadImage(t.image))),e=this.commonFunction.canvasScale();this.curWidthK=e.curWidthK,this.curHeightK=e.curHeightK;const i=yield this.commonFunction.renderImages(t);this.run(i)}))}render(t){return g(this,void 0,void 0,(function*(){this.context.clearRect(0,0,this.canvas.node.width,this.canvas.node.height),this.commonFunction.drawImage(t,this.imagesOptions),this.commonFunction.drawText(this.textOptions)}))}run(t){return g(this,void 0,void 0,(function*(){this.render(t),this.animation=requestAnimationFrame((()=>{this.run(t)}))}))}buttonsHover(t,e){t.sy=e}buttonsClick(t,e){t.sy=2*e}canvasMoveHundler(t,e,i){i.forEach((e=>{const i=this.commonFunction.scaleCoords(e,this.curWidthK,this.curHeightK);this.commonFunction.determineCoords(t,i)?(this.buttonsHover(e,e.stepY),this.changeAnimation(e,!0)):(this.buttonsHover(e,0),this.changeAnimation(e,!1))}))}changeAnimation(t,e){this.textOptions.forEach((i=>{i.text===t.name&&(i.animation=e)}))}stopAnimation(t){setTimeout(t,250),setTimeout((()=>cancelAnimationFrame(this.animation)),250)}canvasClickHundler(t,e,i){i.forEach((e=>{const i=this.commonFunction.scaleCoords(e,this.curWidthK,this.curHeightK);if(this.commonFunction.determineCoords(t,i))switch(e.name){case"Магазин":this.buttonsClick(e,e.stepY),this.stopAnimation(this.onSelectShop);break;case"Меню":this.buttonsClick(e,e.stepY),this.stopAnimation(this.onBack),this.music.onStart();break;case"1":this.buttonsClick(e,e.stepY),this.stopAnimation((()=>this.startLevel(1)));break;case"2":this.buttonsClick(e,e.stepY),this.stopAnimation((()=>this.startLevel(2)));break;case"3":this.buttonsClick(e,e.stepY),this.stopAnimation((()=>this.startLevel(3)));break;case"4":this.buttonsClick(e,e.stepY),this.stopAnimation((()=>this.startLevel(4)))}else this.buttonsClick(e,0)}))}}const u={driedEggs:{name:"Порошковый",costs:"130/180/230/280/330/380",src:"../images/shop/houses/driedEggs/driedEggs-01.png",currentStage:1}},p={well:{name:"Колодец",costs:"200/250/300",src:"../images/shop/wells/well-01.png",currentStage:1},depot:{name:"Склад",costs:"150/200/250",src:"../images/shop/depots/depot-01.png",currentStage:1},cage:{name:"Клетка",costs:"100/150/200",src:"../images/shop/cages/cage-01.png",currentStage:1}},x={car:{name:"Автомобиль",costs:"100/150/200",src:"../images/shop/cars/car-01.png",currentStage:1}},w={dog:{name:"Собака",costs:"100/150/200",src:"../images/shop/dogs/dog-01.png",currentStage:1},cat:{name:"Кот",costs:"100/150/200",src:"../images/shop/cats/cat-01.png",currentStage:1}};let f,y="10000";const v=[];class b extends t{constructor(e){super(e),this.wrapper=new t(this.node,"div","wrapper shop",""),new t(this.wrapper.node,"h2","shop__title","");const i=new t(this.wrapper.node,"div","shop__main",""),s=new t(i.node,"div","shop__main-block","");this.createContentBlocks(s.node,"contantBlock",12,"5",u);const n=new t(i.node,"div","shop__main-aside","");this.createContentBlocks(n.node,"contantAside",3,"3",p);const a=new t(this.wrapper.node,"div","shop__main-under",""),o=new t(a.node,"div","shop__main-under__engineering","");this.createContentBlocks(o.node,"contantEngineer",2,"3",x);const h=new t(a.node,"div","shop__main-under__block",""),r=new t(h.node,"div","shop__main-under__stars","");new t(r.node,"img","stars__img","").node.src="../images/shop/star/star_anim.png";const c=new t(r.node,"div","stars__count",y);c.node.setAttribute("data-amount",y),f=c;const d=new t(a.node,"div","shop__main-under__pets","");this.createContentBlocks(d.node,"contantPets",2,"3",w),new t(h.node,"button","btn__shop btn","ОК").node.onclick=()=>{this.gameMapBack()}}gameMapBack(){throw new Error("Method not implemented.")}createContentBlocks(e,i,s,n,a){let o;for(o in a){const s=new t(e,"div",i,"");s.node.setAttribute("curstage",`${a[o].currentStage}`),s.node.setAttribute("maxstage",n),s.node.setAttribute("costs",a[o].costs);const h=a[o].currentStage,r=a[o].costs,c=a[o].name,d=a[o].costs.split("/")[+h-1],l=a[o].src.split("-")[0]+`-0${a[o].currentStage}.png`,g=a[o].name,m=5===l.split("/").length?l.split("/")[3]:l.split("/")[4],u=(new t(s.node,"p","content__name",c),new t(s.node,"div","content","")),p=new t(u.node,"div","content__block",""),x=new t(p.node,"img",`${m} content__img`,"");x.node.src=l;const w=new t(u.node,"button","content__btn",d),f=new t(u.node,"img","content__btn-img","");f.node.style.right=d.length>3?"36px":"40px",f.node.src="../images/shop/star/star_btn.png",this.setBackground(p,d),this.setButtonStyle(w,d),w.node.onclick=()=>this.shopButtonClick(s,w,x,l,r,a,g),v.push(s),this.updateShopBackground()}for(;e.childElementCount<s;)new t(e,"div",i,"")}setBackground(t,e){t.node.style.backgroundImage=`url(${+e<=+y?"../images/shop/layers/shop_layer-blue.png":"../images/shop/layers/shop_layer-grey.png"})`}setButtonStyle(t,e){+e<=+y&&(t.node.style.transform="translate(-50%)",t.node.classList.add("btn"))}shopButtonClick(t,e,i,s,n,a,o){let h,r;for(h in a)a[h].name===o&&(a[h].currentStage+=1,r=a[h].currentStage);const c=t.node.getAttribute("maxstage");if(!c||!r)return;if(+c==r-1)return;const d=n.split("/")[r-2];if(+y<+d)return;const l=""+(+y-+d);y=l,f.node.style.animationName="money_anim",f.node.onanimationend=()=>{f.node.style.animationName="money_backAnim",f.node.textContent=l},t.node.setAttribute("curstage",`${r}`);const g=s.split("-")[0]+`-0${r}.png`,m=n.split("/")[r-1];this.updateShopData(e,i,g,m)}updateShopData(t,e,i,s){t.node.textContent=s,e.node.src=i,this.updateShopBackground()}updateShopBackground(){v.forEach((e=>{const i=e.node.getAttribute("curstage"),s=e.node.getAttribute("maxstage"),n=e.node.getAttribute("costs");if(!i||!n||!s)return;const a=n.split("/")[+i-1],o=e.node.childNodes[1],h=o.childNodes[0],r=o.childNodes[1],c=o.childNodes[2];+s==+i?(h.style.backgroundImage="none",r.style.zIndex="-2",c.style.zIndex="-2",new t(o,"div","level__max","")):+a>+y&&(h.style.backgroundImage="url(../images/shop/layers/shop_layer-grey.png)",r.classList.remove("btn"))}))}}class S{constructor(t){this.gameFrame=0,this.userInterfaceOptions=t,this.animationImage=this.userInterfaceOptions.filter((t=>"animation"===t.type))}coinAnimation(){const t=this.animationImage.find((t=>"coin"===t.name)),e=t.sheight*t.frameY;this.gameFrame%5==0&&(t.sy<e?t.sy+=t.stepY:t.sy=0),this.gameFrame+=1}}const C=[{type:"picture",name:"endPanel",image:"images/level/panels/end_panel.png",x:339,y:102,width:922,height:996,sx:0,sy:0,swidth:0,sheight:0},{type:"animation",name:"coin",image:"images/level/uiLevel/gold_coin.png",x:420,y:290,width:70,height:70,sx:0,sy:128,swidth:32,sheight:32},{type:"animation",name:"time",image:"images/level/uiLevel/anim_clock.png",x:420,y:420,width:70,height:70,sx:0,sy:120,swidth:40,sheight:40},{type:"animation",name:"star",image:"images/level/panels/menu_star.png",x:422,y:550,width:70,height:62,sx:0,sy:0,swidth:40,sheight:36}],k=[{text:"Результаты уровня",fontSize:"62px Vag_Rounded-Bold CY",color:"#fff",x:522,y:200,animation:!1},{text:"Монет:",fontSize:"50px Vag_Rounded-Bold CY",color:"#fff",x:510,y:340,animation:!1},{text:"Время:",fontSize:"50px Vag_Rounded-Bold CY",color:"#fff",x:510,y:478,animation:!1},{text:"Бонус:",fontSize:"50px Vag_Rounded-Bold CY",color:"#fff",x:510,y:600,animation:!1}],Y=[{type:"button",name:"Ок",image:"images/level/panels/startBtn.png",stepY:48,stepX:0,hover:1,click:2,x:690,y:900,width:200,height:77,sx:0,sy:0,swidth:128,sheight:48}],_=[{text:"Ок",fontSize:"32px Vag_Rounded-Bold CY",color:"#fff",x:770,y:944,animation:!1}],I=[{text:"Монеты",fontSize:"40px Vag_Rounded-Bold CY",color:"yellow",x:710,y:340,animation:!1},{text:"Время",fontSize:"40px Vag_Rounded-Bold CY",color:"yellow",x:710,y:478,animation:!1},{text:"Бонус",fontSize:"40px Vag_Rounded-Bold CY",color:"yellow",x:710,y:600,animation:!1}],B={text:"ЗОЛОТОЙ",fontSize:"40px Vag_Rounded-Bold CY",color:"yellow",x:950,y:620,animation:!1},P={text:"СЕРЕБРЯНЫЙ",fontSize:"40px Vag_Rounded-Bold CY",color:"#f7f9f7",x:930,y:620,animation:!1},T=[{deafultStar:25,goldStar:75,silverStar:25,x:1495,y:1183,goldMin:1,goldSec:0,silvMin:2,silvSec:0},{deafultStar:40,goldStar:120,silverStar:40,x:1495,y:1183,goldMin:1,goldSec:30,silvMin:2,silvSec:40},{deafultStar:50,goldStar:150,silverStar:50,x:1495,y:1183,goldMin:2,goldSec:0,silvMin:3,silvSec:0}];class M{constructor(){if(this.levelShop={chicken:100,pig:1e3,well:19},this.totalText={name:"total",text:"0",fontSize:"40px Vag_Rounded-Bold CY",color:"#f7f21a",x:1076,y:126,animation:!1},this.btnDisable={chicken:!1,pig:!1,well:!1},this.wellDisable=!1,M._instance)throw new Error("Instantiation failed: use InitialData.getInstance() instead of new.")}static getInstance(){return M._instance}checkTotal(t){return+this.totalText.text>=t}changeTotalMinus(t){this.checkTotal(this.levelShop[t])&&(this.totalText.text=+this.totalText.text-this.levelShop[t]+"",this.changeCoords(),this.checkDisable())}changeTotalPlus(t){this.totalText.text=+this.totalText.text+t+"",this.changeCoords(),this.checkDisable()}checkDisable(){for(const t in this.btnDisable)this.checkTotal(this.levelShop[t])?this.btnDisable[t]=!0:this.btnDisable[t]=!1}changeCoords(){1===this.totalText.text.length&&(this.totalText.x=1093),2===this.totalText.text.length&&(this.totalText.x=1082),3===this.totalText.text.length&&(this.totalText.x=1070)}}M._instance=new M;const X=M.getInstance();class A{constructor(t,e,i){this.canvas=t,this.context=e,this.level=i,this.x=1388,this.y=1183,this.min=0,this.sec=0,this.bonus="",this.isRunning=!0,this.goldMin=T[this.level-1].goldMin,this.goldSec=T[this.level-1].goldSec,this.silvMin=T[this.level-1].silvMin,this.silvSec=T[this.level-1].silvSec,this.textX=T[this.level-1].x,this.textY=T[this.level-1].y,this.strip={gold:"images/level/uiLevel/play_strip.png",silver:"images/level/uiLevel/play_strip_silver.png",x:1470,y:1148,width:120,height:48},this.clock={src:"images/level/uiLevel/play_clock.png",x:1340,y:1150,width:38,height:44},this.goldImg=new Image,this.goldImg.src=this.strip.gold,this.silvImg=new Image,this.silvImg.src=this.strip.silver,this.clockImg=new Image,this.clockImg.src=this.clock.src,this.goldCup=new Image,this.goldCup.src="images/level/panels/complete_gold_cup.png",this.silvCup=new Image,this.silvCup.src="images/level/panels/complete_silver_cup.png"}content(t,e){return(t<=9?`0${t}`:t)+":"+(Math.trunc(e)<=9?`0${Math.trunc(e)}`:Math.trunc(e))}drawText(){this.context.font="30px Vag_Rounded-Bold CY",this.context.fillStyle="white",this.min>=60||(this.context.fillText(this.content(this.min,this.sec),this.x,this.y),this.isRunning&&this.updateTimer(),this.drawStrip())}updateTimer(){this.sec>=60&&(this.sec=0,this.min+=1),this.sec+=1/60}drawStrip(){new c(this.clockImg,this.clock.x,this.clock.y,this.clock.width,this.clock.height).draw(this.context),this.min>this.silvMin||this.min>=this.silvMin&&this.sec>=this.silvSec||(new c(this.min>=this.goldMin&&this.sec>=this.goldSec?this.silvImg:this.goldImg,this.strip.x,this.strip.y,this.strip.width,this.strip.height).draw(this.context),this.min>=this.goldMin&&this.sec>=this.goldSec?(this.context.fillStyle="#f7f9f7",this.context.fillText(this.content(this.silvMin,this.silvSec),this.textX,this.textY)):(this.context.fillStyle="yellow",this.context.fillText(this.content(this.goldMin,this.goldSec),this.textX,this.textY)))}countBonus(){const t=T[this.level-1];return this.min>this.silvMin||this.min>=this.silvMin&&this.sec>=this.silvSec?(this.bonus="default",`${t.deafultStar}`):this.min>=this.goldMin&&this.sec>=this.goldSec?(this.bonus="silver",`${t.deafultStar+t.silverStar}`):(this.bonus="gold",`${t.deafultStar+t.goldStar}`)}showCup(){let t;"default"!==this.bonus&&("silver"===this.bonus?(I.push(P),t=new c(this.silvCup,920,280,250,250),t.draw(this.context)):"gold"===this.bonus&&(I.push(B),t=new c(this.goldCup,920,280,250,250),t.draw(this.context)))}endPanelView(){I.forEach((t=>{"Время"===t.text&&(t.text=this.content(this.min,this.sec),this.timeAnimation(t)),"Монеты"===t.text&&(t.text=X.totalText.text),"Бонус"===t.text&&(t.text=this.countBonus())}))}timeAnimation(t){let e;setTimeout((()=>{e=setInterval((()=>{this.countEndTime(t,e)}),12)}),1e3)}countEndTime(t,e){this.sec>0?this.sec-=1:this.min>0?(this.sec=59,this.min-=1):clearInterval(e),t.text=this.content(this.min,this.sec)}checkZeroTime(){0===this.min&&0===Math.trunc(this.sec)&&this.showCup()}}const R=[{type:"picture",name:"mainField",image:"images/level/level-back.jpg",x:0,y:0,width:1600,height:1200,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"buttomBar",image:"images/level/uiLevel/play_menu.png",x:0,y:1032,width:1600,height:170,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"buy",image:"images/level/animal/buy_panel.png",x:0,y:0,width:700,height:130,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"road",image:"images/level/uiLevel/road.png",x:970,y:0,width:630,height:166,sx:0,sy:0,swidth:0,sheight:0}],E=[{type:"button",name:"mainArea",image:"images/level/level-back.jpg",x:400,y:430,hover:1,click:2,stepY:0,stepX:0,width:740,height:420,sx:0,sy:0,swidth:0,sheight:0},{type:"button",name:"levelPanel",image:"images/level/uiLevel/but_panel.png",stepY:124,stepX:0,hover:1,click:2,x:1328,y:1046,width:270,height:154,sx:0,sy:0,swidth:288,sheight:124},{type:"button",name:"Меню",image:"images/level/uiLevel/button_menu.png",stepY:44,stepX:0,hover:1,click:2,x:8,y:1110,width:138,height:78,sx:0,sy:0,swidth:80,sheight:44},{type:"button",name:"pig",image:"images/level/animal/buy_pig.png",stepY:64,stepX:0,hover:1,click:2,x:118,y:2,width:115,height:123,sx:0,sy:192,swidth:60,sheight:64},{type:"button",name:"chicken",image:"images/level/animal/buy_chicken.png",stepY:64,stepX:0,hover:1,click:2,x:4,y:2,width:113,height:122,sx:0,sy:192,swidth:60,sheight:64},{type:"button",name:"cow",image:"images/level/animal/buy_cow.png",stepY:64,stepX:0,hover:1,click:2,x:233,y:2,width:113,height:122,sx:0,sy:192,swidth:60,sheight:64},{type:"button",name:"ostrich",image:"images/level/animal/buy_ostrich.png",stepY:64,stepX:0,hover:1,click:2,x:346,y:2,width:113,height:122,sx:0,sy:192,swidth:60,sheight:64},{type:"button",name:"dog",image:"images/level/animal/buy_dog1.png",stepY:64,stepX:0,hover:1,click:2,x:460,y:2,width:113,height:122,sx:0,sy:192,swidth:60,sheight:64},{type:"button",name:"cat",image:"images/level/animal/buy_cat1.png",stepY:64,stepX:0,hover:1,click:2,x:578,y:2,width:113,height:122,sx:0,sy:192,swidth:60,sheight:64}],H=[{type:"animation",name:"coin",image:"images/level/uiLevel/gold_coin.png",x:1078,y:35,width:50,height:50,stepY:32,stepX:0,hover:1,click:2,frameY:15,sx:0,sy:0,swidth:32,sheight:32}],z=[{name:"storage",maxX:0,maxY:924,speed:36},{name:"car",maxX:0,maxY:950,speed:36},{name:"well",maxX:0,maxY:146,speed:25},{name:"waterIndicator",maxX:0,maxY:200,speed:24}],O=[{text:"Меню",fontSize:"24px Vag_Rounded-Bold CY",color:"#fff",x:41,y:1153,animation:!1}],D=["images/pets/chicken/down.png","images/pets/chicken/down-left.png","images/pets/chicken/down-right.png","images/pets/chicken/up.png","images/pets/chicken/up-left.png","images/pets/chicken/up-right.png","images/pets/chicken/left.png","images/pets/chicken/right.png","images/pets/chicken/eat-left.png","images/pets/chicken/eat-right.png","images/pets/chicken/death.png","images/pets/chicken/shadow.png","images/pets/chicken/pic.png","images/pets/pig/down.png","images/pets/pig/down-left.png","images/pets/pig/down-right.png","images/pets/pig/up.png","images/pets/pig/up-left.png","images/pets/pig/up-right.png","images/pets/pig/left.png","images/pets/pig/right.png","images/pets/pig/eat-left.png","images/pets/pig/eat-right.png","images/pets/pig/death.png","images/pets/pig/shadow.png","images/pets/pig/pic.png","images/pets/bear-panda/down.png","images/pets/bear-panda/down-left.png","images/pets/bear-panda/down-right.png","images/pets/bear-panda/up.png","images/pets/bear-panda/up-left.png","images/pets/bear-panda/up-right.png","images/pets/bear-panda/left.png","images/pets/bear-panda/right.png","images/pets/bear-panda/cage.png","images/pets/bear-panda/shadow.png","images/pets/bear-panda/pic.png","images/cage/build-1.png","images/cage/break-1.png","images/cage/mask.png","images/products/egg/normal.png","images/products/egg/hover.png","images/products/egg/mask.png","images/products/meat/normal.png","images/products/meat/hover.png","images/products/meat/mask.png","images/products/driedEggs/normal.png","images/products/driedEggs/hover.png","images/products/driedEggs/mask.png","images/level/uiLevel/hungerBar.png","images/level/grass.png"];class F{constructor(t,e,i,s,n,a,o,h,r,c,d,l,g){this.type=t,this.name=e,this.id=i,this.state=s,this.image="images/pets/"+this.name+"/down.png",this.coordX=n,this.coordY=a,this.width=o,this.height=h,this.shadowWidth=l,this.shadowHeight=g,this.frameNum=r,this.frame=Math.floor(Math.random()*this.frameNum),this.wantX=this.coordX,this.wantY=this.coordY,this.food=60*c,this.lastEat=0,this.speedBoost=1,this.opacity=1,this.opacity=.5,this.isWantGrass=!1,this.isEating=!1,this.eatTime=-1,this.productAge=0,this.productNeed=1200,this.productName=d,this.fallY=this.coordY,"shadow"===this.state&&(this.coordY=-500),this.rotate=0,this.cageBuild=0,this.cageRemain=0,this.isEscape=!1,this.speedX=this.speedY=0}}class V extends F{constructor(t,e,i){super("pet","chicken",t,"shadow",e,i,64,64,16,15,"egg",44,24)}}class W extends F{constructor(t,e,i){super("pet","pig",t,"shadow",e,i,112,112,16,20,"meat",60,20)}}class L extends F{constructor(t,e,i,s){let n=0,a=0,o="";0===s&&(n=a=100,o="bear-panda"),super("bear",o,t,"shadow",e,i,n,a,16,0,"",60,28)}}class K{constructor(t,e,i){this.age=0,this.coordX=t,this.coordY=e,this.maxAge=i,this.isUsed=!1}}class N{constructor(t,e,i){this.name=t,this.state="earth",this.age=0,this.blinkAge=480,this.maxAge=660,this.coordX=e,this.coordY=i,this.isBlinking=!1,this.isHover=!1,this.wantX=660,this.wantY=925,this.speedX=(this.wantX-this.coordX)/12,this.speedY=(this.wantY-this.coordY)/12}}class j{constructor(t,e){this.images=new Map,this.canvas=t,this.context=e,this.commonFunction=new l(this.canvas,this.context),this.imagesPath=D,this.animals=[],this.products=[],this.grass=[],this.id=0,this.areaX=355,this.areaY=355,this.areaWidth=765,this.areaHeight=475,this.heightRatio=1.3333333,this.gameFrame=0,this.staggeredFrames=3}moveHundler(t,e,i){this.products.forEach((s=>{const n={currentX:s.coordX/e,currentY:s.coordY/i,currentW:96/e,currentH:96/i};this.commonFunction.determineCoords(t,n)?s.isHover=!0:s.isHover=!1}));let s=[];return this.animals.forEach((t=>{s.push(t.name)})),s}clickHundler(t,e,i){const s=[];return this.products.forEach(((n,a,o)=>{if("earth"!==n.state)return;const h={currentX:n.coordX/e,currentY:n.coordY/i,currentW:96/e,currentH:96/i};this.commonFunction.determineCoords(t,h)&&(s.push(n.name),n.state="fly",n.age=0)})),this.animals.forEach(((n,a,o)=>{if("bear"!==n.type)return;const h={currentX:n.coordX/e,currentY:n.coordY/i,currentW:2*n.width/e,currentH:2*n.height/i};this.commonFunction.determineCoords(t,h)&&(n.cageRemain=30,n.cageBuild<8&&n.cageBuild++,8===n.cageBuild&&"cage"!==n.state?(n.state="cage",n.frame=0,n.cageRemain=720):8===n.cageBuild&&(s.push("bear-1"),n.state="fly",n.productAge=0,n.wantX=660,n.wantY=945,n.speedX=(n.wantX-n.coordX)/12,n.speedY=(n.wantY-n.coordY)/12),s.push(""))})),s}startLevel(){this.imagesPath.forEach((t=>{return e=this,i=void 0,n=function*(){let e="";const i=t.slice(t.lastIndexOf("/")+1,-4);e=t.includes("pets")?t.slice(12,12+t.slice(12).indexOf("/"))+"-"+i:t.includes("products")?t.slice(16,16+t.slice(16).indexOf("/"))+"-"+i:i,this.images.set(e,yield this.commonFunction.loadImage(t))},new((s=void 0)||(s=Promise))((function(t,a){function o(t){try{r(n.next(t))}catch(t){a(t)}}function h(t){try{r(n.throw(t))}catch(t){a(t)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(o,h)}r((n=n.apply(e,i||[])).next())}));var e,i,s,n}))}renderLevel(t,e,i){const s=[];this.products.forEach((t=>s.push(t))),this.grass.forEach((t=>s.push(t))),this.animals.forEach((t=>s.push(t))),s.sort(this.sortCoord),s.forEach((s=>{s instanceof N?this.renderProduct(s,t,e,i):s instanceof K?this.renderGrass(s,t,e,i):this.renderAnimal(s,t,e,i)})),i||(this.gameFrame+=1)}renderProduct(t,e,i,s){this.context.restore(),this.context.globalAlpha=1;let n=t.name;t.isHover?n+="-hover":n+="-normal";const a=this.images.get(n);let o=96,h=96;if("fly"===t.state&&(o=h=48*(2-t.age/15)),t.isBlinking&&this.gameFrame%40<20&&(this.context.globalAlpha=.5),a instanceof HTMLImageElement&&this.context.drawImage(a,0,0,48,48,t.coordX,t.coordY,o,h),"fly"===t.state)return t.age++,this.isNear(t.coordX,t.coordY,t.wantX,t.wantY,100)&&this.products.splice(this.products.indexOf(t),1),t.coordX+=t.speedX,void(t.coordY+=t.speedY);s||(t.age++,t.age>=t.maxAge&&this.gameFrame%40<20?this.products.splice(this.products.indexOf(t),1):t.age>=t.blinkAge&&(t.isBlinking=!0))}renderGrass(t,e,i,s){this.context.restore(),this.context.globalAlpha=1;const n=Math.min(t.age,t.maxAge),a=this.images.get("grass"),o=n%4*48,h=48*Math.floor(n/4);a instanceof HTMLImageElement&&this.context.drawImage(a,o,h,48,48,t.coordX,t.coordY,96,96),s||t.age++,t.age%180==0&&(t.isUsed=!1)}renderAnimal(t,e,i,s){this.context.restore(),this.context.globalAlpha=1;let n=t.name+"-"+t.state,a=new Image,o=0,h=0,r=0,c=0,d=0,l=0,g=0,m=0;if("death"===t.state&&15===t.frame&&t.opacity<=0)return void this.animals.splice(this.animals.indexOf(t),1);"death"===t.state&&15===t.frame&&(this.context.globalAlpha=t.opacity,t.opacity-=.025),"shadow"===t.state&&(a=this.images.get(n),o=0,h=0,r=t.shadowWidth,c=t.shadowHeight,d=t.coordX+t.width-t.shadowWidth,l=t.fallY+1.5*t.height-t.shadowHeight,g=2*r,m=2*c,this.context.globalAlpha=t.opacity,this.drawImage(a,o,h,r,c,d,l,g,m),n=t.name+"-down",this.context.restore(),this.context.globalAlpha=1),"fly"===t.state&&(n=t.name+"-cage"),a=this.images.get(n),o=t.width*(t.frame%4),h=t.height*Math.floor(t.frame/4),r=t.width,c=t.height,d=t.coordX,l=t.coordY,g=2*r,m=2*c,"fly"===t.state&&(g=r*Math.max(2-t.productAge/12,.1),m=c*Math.max(2-t.productAge/12,.1));const u=.6;return"pic"===t.state&&(o=h=0,g-=1.2*t.frame,m-=1.2*t.frame),"pic"===t.state&&(this.context.save(),this.context.translate(t.coordX+(t.width-u*t.frame),t.coordY+(t.height-u*t.frame)),this.context.rotate(t.rotate*Math.PI/180),this.context.translate(-(t.coordX+(t.width-u*t.frame)),-(t.coordY+(t.height-u*t.frame)))),this.drawImage(a,o,h,r,c,d,l,g,m),this.context.restore(),"pic"===t.state?(t.frame+=3,t.rotate+=24,t.rotate%=360,t.speedBoost=10,0===t.wantX?t.coordX-=t.speedBoost:t.coordX+=t.speedBoost,t.coordY-=t.speedBoost,t.state="pic",void(t.frame*u-Math.min(t.width,t.height)>-5&&this.animals.splice(this.animals.indexOf(t),1))):"shadow"!==t.state||s?void("shadow"!==t.state&&("death"!==t.state?"bear"===t.type?this.renderBear(t,s):this.renderPet(t,s):t=this.nextFrame(t,s))):("bear"===t.type?(t.coordY%10==0&&(t.coordY=-15001),t.opacity+=.005,t.opacity=Math.min(t.opacity,1)):t.opacity+=.025,t.coordY+=50,void(t.coordY-t.fallY>=0&&(t.state="down")))}renderBear(t,e){let i=new Image,s=0,n=0,a=0,o=0,h=0,r=0,c=0,d=0;if(t.isEscape)return e||(t.speedBoost=3,(t=this.nextFrame(t,e)).speedBoost=7,t=this.nextCoord(t)),void((t.coordX<-100||t.coordX>1600)&&this.animals.splice(this.animals.indexOf(t),1));if(i=this.images.get("build-1"),s=t.cageBuild%3*160,n=160*Math.floor(t.cageBuild/3),a=160,o=160,h=t.coordX-160/6,r=t.coordY-32,c=240,d=240,"fly"===t.state&&(c=160*Math.max(1.5-t.productAge/12,.1),d=160*Math.max(1.5-t.productAge/12,.1)),"cage"===t.state&&t.cageRemain<=180&&(s=t.frame%3*160,n=160*Math.floor(t.frame/3),i=this.images.get("break-1")),this.drawImage(i,s,n,160,160,h,r,c,d),!e){if("fly"===t.state)return t.productAge++,this.isNear(t.coordX,t.coordY,t.wantX,t.wantY,250)&&this.animals.splice(this.animals.indexOf(t),1),t.coordX+=t.speedX,void(t.coordY+=t.speedY);if("cage"===t.state)return t.cageRemain<=0?(t.isEscape=!0,t.wantY=t.coordY,void(t.coordX+t.width/2<800?(t.state="left",t.wantX=-200):(t.state="right",t.wantX=1800))):(t.cageRemain<=180&&(t=this.nextFrame(t,e)),void t.cageRemain--);if(t.cageBuild>0&&(t.cageRemain<=0&&(t.cageBuild--,t.cageRemain=120),t.cageRemain--),t.speedBoost=1.4-t.cageBuild/10,t=this.nextFrame(t,e),this.isNear(t.coordX,t.coordY,t.wantX,t.wantY))for(;this.isNear(t.coordX,t.coordY,t.wantX,t.wantY,100);)t.wantX=this.areaX+Math.floor(Math.random()*this.areaWidth),t.wantY=this.areaY+Math.floor(Math.random()*this.areaHeight);t.speedBoost=.6-t.cageBuild/16,t=this.nextCoord(t),this.animals.forEach((e=>{"pet"===e.type&&"shadow"!==e.state&&this.isBearNear(e.coordX,e.coordY,e.width,e.height,t.coordX,t.coordY,t.width,t.height,60)<=0&&this.petAway(e)}))}}renderPet(t,e){let i=new Image,s=0,n=0,a=0,o=0,h=0,r=0,c=0,d=0;(t=this.nextFrame(t,e)).productAge>=t.productNeed&&Math.floor(100*Math.random())+1===100&&(this.createProduct(t.productName,t.coordX,t.coordY),t.productAge=0);let l=(t.food-t.lastEat)/t.food;if(t.lastEat<t.food&&(i=this.images.get("hungerBar"),s=0,n=0,a=Math.floor(40*l),o=8,h=t.coordX+t.width-40,r=t.coordY+1.5*t.height+8,c=2*a,d=2*o,this.drawImage(i,s,n,a,o,h,r,c,d)),!e){if(l<=0)return t.state="death",void(t.frame=0);if(l<=.38){if(!t.isWantGrass&&this.grass.length>0){const e=this.findGrass(t);-1!==e&&(this.grass[e].isUsed=!0,t.isWantGrass=!0)}t.speedBoost=2}if(this.isNear(t.coordX,t.coordY,t.wantX,t.wantY))if(t.isWantGrass)if(t.state.includes("eat")){if(t.frame===t.frameNum-1){t.state=t.state.slice(4,t.state.length),t.lastEat-=.4*t.food;const e=this.findGrass(t);if(this.grass.splice(e,1),t.isWantGrass=!1,l=(t.food-t.lastEat)/t.food,l<=.95){const e=this.findGrass(t);-1!==e&&(this.grass[e].isUsed=!0,t.isWantGrass=!0),t.speedBoost=2}}}else t.state.includes("left")?t.state="eat-left":t.state="eat-right",t.frame=0;else for(;this.isNear(t.coordX,t.coordY,t.wantX,t.wantY,50);)t.wantX=this.areaX+Math.floor(Math.random()*this.areaWidth),t.wantY=this.areaY+Math.floor(Math.random()*this.areaHeight);t=this.nextCoord(t)}}drawImage(t,e,i,s,n,a,o,h,r){t instanceof HTMLImageElement&&this.context.drawImage(t,e,i,s,n,a,o,h,r)}nextFrame(t,e){if(!e&&(t.productAge++,t.state.includes("eat")||t.lastEat++,"death"!==t.state||15!==t.frame)){let e=t.speedBoost;("death"===t.state||t.state.includes("eat"))&&(e=.5),(this.gameFrame%Math.ceil(this.staggeredFrames/e)==0||this.gameFrame%Math.ceil(this.staggeredFrames/e)==0)&&(t.frame=(t.frame+1)%t.frameNum)}return t.speedBoost=1,t}nextCoord(t){if(!t.state.includes("eat")){let e="";switch(t.coordY-t.wantY<-2?e="down":t.coordY-t.wantY>2&&(e="up"),t.coordX-t.wantX<-2?e+=(e.length>0?"-":"")+"right":t.coordX-t.wantX>2&&(e+=(e.length>0?"-":"")+"left"),e){case"down":t.coordY+=1.75*t.speedBoost;break;case"down-right":t.coordY+=1.25*t.speedBoost,t.coordX+=1.25*t.speedBoost;break;case"down-left":t.coordY+=1.25*t.speedBoost,t.coordX-=1.25*t.speedBoost;break;case"up":t.coordY-=1.75*t.speedBoost;break;case"up-right":t.coordY-=1.25*t.speedBoost,t.coordX+=1.25*t.speedBoost;break;case"up-left":t.coordY-=1.25*t.speedBoost,t.coordX-=1.25*t.speedBoost;break;case"right":t.coordX+=1.75*t.speedBoost;break;case"left":t.coordX-=1.75*t.speedBoost}""!==e&&(t.state=e)}return t}isNear(t,e,i,s,n=10){return(t-i)*(t-i)+(e-s)*(e-s)<=n}isBearNear(t,e,i,s,n,a,o,h,r=10){const c=t+Math.trunc(i/2),d=e+Math.trunc(s/2),l=n+Math.trunc(o/2),g=a+Math.trunc(h/2),m=Math.abs(c-l),u=Math.abs(d-g);let p=-1;if(m-r<(i+o)/2&&u+r>=(s+h)/2)p=Math.max(1,u-(s+h)/2);else if(m+r>=(i+o)/2&&u-r<(s+h)/2)p=Math.max(m-(i+o)/2);else if(m+r>=(i+o)/2&&u+r>=(s+h)/2){const t=m-(i+o)/2,e=u-(s+h)/2;p=Math.sqrt(t*t+e*e)}return p}findGrass(t){let e=1e5,i=-1;return this.grass.forEach(((s,n)=>{!s.isUsed&&(s.coordX-t.coordX)*(s.coordX-t.coordX)+(s.coordY-t.coordY)*(s.coordY-t.coordY)<e&&(e=(s.coordX-t.coordX)*(s.coordX-t.coordX)+(s.coordY-t.coordY)*(s.coordY-t.coordY),t.wantX=s.coordX,t.wantY=s.coordY,i=n)})),i}petAway(t){t.state="pic",t.coordX+t.width/2<800?t.wantX=0:t.wantX=1600,t.frame=0}createAnimal(t){"number"==typeof this.id&&(this.id=0),"chicken"===t&&this.animals.push(new V(this.id,this.areaX+Math.floor(Math.random()*this.areaWidth),this.areaY+Math.floor(Math.random()*this.areaHeight))),"pig"===t&&this.animals.push(new W(this.id,this.areaX+Math.floor(Math.random()*this.areaWidth),this.areaY+Math.floor(Math.random()*this.areaHeight))),"bear"===t&&this.animals.push(new L(this.id,this.areaX+Math.floor(Math.random()*this.areaWidth),this.areaY+Math.floor(Math.random()*this.areaHeight),0)),this.id++}createGrass(t,e,i,s){e-=24*s;const n=42;(t-=24*i)-84>=this.areaX&&this.grass.push(new K(t-84,e,Math.floor(5*Math.random())+3)),t-n>=this.areaX&&e+n<=this.areaY+this.areaHeight&&this.grass.push(new K(t-n,e+n,Math.floor(5*Math.random())+3)),e+84<=this.areaY+this.areaHeight&&this.grass.push(new K(t,e+84,Math.floor(5*Math.random())+3)),t+n<=this.areaX+this.areaWidth&&e+n<=this.areaY+this.areaHeight&&this.grass.push(new K(t+n,e+n,Math.floor(5*Math.random())+3)),t+n<=this.areaX+this.areaWidth&&this.grass.push(new K(t+84,e,Math.floor(5*Math.random())+3)),t-n>=this.areaX&&e-n>=this.areaX&&this.grass.push(new K(t-n,e-n,Math.floor(5*Math.random())+3)),e-84>=this.areaY&&this.grass.push(new K(t,e-84,Math.floor(5*Math.random())+3)),t+n<=this.areaX+this.areaWidth&&e-n>=this.areaX&&this.grass.push(new K(t+n,e-n,Math.floor(5*Math.random())+3)),t-n>=this.areaX&&this.grass.push(new K(t-n,e,Math.floor(5*Math.random())+7)),e+n<=this.areaY+this.areaHeight&&this.grass.push(new K(t,e+n,Math.floor(5*Math.random())+7)),t+n<=this.areaX+this.areaWidth&&this.grass.push(new K(t+n,e,Math.floor(5*Math.random())+7)),e+n<=this.areaY+this.areaHeight&&this.grass.push(new K(t,e-n,Math.floor(5*Math.random())+7)),this.grass.push(new K(t,e,Math.floor(4*Math.random())+12))}createProduct(t,e,i){this.products.push(new N(t,e,i))}sortCoord(t,e){let i=t.coordY,s=e.coordY;const n={chicken:1,pig:.1,"bear-panda":.1};return i-=t instanceof K?108:t instanceof N?84:t.height*n[t.name],s-=e instanceof K?108:e instanceof N?84:e.height*n[e.name],i-s}}const J=[{type:"picture",name:"pause",image:"images/level/panels/pause_panel.png",x:569,y:300,width:462,height:600,sx:0,sy:0,swidth:0,sheight:0}],G=[{type:"button",name:"Продолжить",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:345,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48},{type:"button",name:"Главное Меню",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:435,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48},{type:"button",name:"Перезапустить",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:525,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48},{type:"button",name:"Карта",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:615,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48},{type:"button",name:"Настройки",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:705,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48},{type:"button",name:"Помощь",image:"images/level/panels/pauseBtn.png",stepY:48,stepX:0,hover:1,click:2,x:674,y:795,width:245,height:70,sx:0,sy:0,swidth:168,sheight:48}],U=[{text:"Продолжить",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:714,y:385,animation:!1},{text:"Главное Меню",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:705,y:476,animation:!1},{text:"Перезапустить",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:705,y:565,animation:!1},{text:"Карта",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:762,y:654,animation:!1},{text:"Настройки",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:734,y:745,animation:!1},{text:"Помощь",fontSize:"27px Vag_Rounded-Bold CY",color:"#fff",x:744,y:835,animation:!1}];class $ extends t{constructor(s){super(s),this.buttonEffect=new e,this.resizeWindow=()=>{this.wrapper.node.style.width=String(window.innerHeight/600*800)+"px"},this.wrapper=new t(this.node,"div","wrapper main",""),this.resizeWindow(),window.addEventListener("resize",this.resizeWindow),this.soundVal="50",this.musicVal=i,this.music=new a;const n=new t(this.wrapper.node,"div","panel panel__settings",""),o=(new t(n.node,"div","panel__name-settings",""),new t(n.node,"div","settings__box","")),h=new t(o.node,"div","sound__box",""),r=(new t(h.node,"div","sound","Звуки"),new t(h.node,"div","sound__bar",""));new t(r.node,"div","sound__volume-min settings__volume",""),this.createRangeInput(r.node,"sound__input settings__range",this.soundVal),new t(r.node,"div","sound__volume-max settings__volume",""),new t(r.node,"div","settings__line","");const c=new t(o.node,"div","music__box",""),d=(new t(c.node,"div","music","Музыка"),new t(c.node,"div","music__bar",""));new t(d.node,"div","music__volume-min settings__volume",""),this.createRangeInput(d.node,"music__input settings__range",this.musicVal),new t(d.node,"div","music__volume-max settings__volume",""),new t(d.node,"div","settings__line","");const l=new t(o.node,"div","screen__box","На весь экран"),g=new t(l.node,"input","settings__checkbox","");g.node.id="fullScreen",g.node.type="checkbox";const m=new t(l.node,"label","fullScreen__label","");m.node.setAttribute("for","fullScreen"),new t(m.node,"div","input__checked","");const u=new t(n.node,"button","btn__settings btn","ОК");this.buttonEffect.devideButton(u.node),u.node.onclick=()=>{var t;this.node.children[0].className.includes("map")?(null===(t=this.node.parentElement)||void 0===t?void 0:t.children[0]).style.display="block":this.onBack()}}createRangeInput(e,i,s){const n=new t(e,"input",i,"");n.node.value=s,n.node.type="range",n.node.min="0",n.node.max="100",n.node.step="1",n.node.onchange=()=>this.volumeChanging(n.node.value,i.split(" ")[0])}onBack(){throw new Error("Method not implemented.")}volumeChanging(t,e){"sound__input"===e?this.soundChange(t):this.musicChange(t)}musicChange(t){this.musicVal=t,this.music.changeMusicVolume(t)}soundChange(t){this.soundVal=t}}class q extends l{constructor(t,e,i,s,n,o){super(t,e),this.initialImage=[],this.initialBtn=[],this.pausePanelImg=this.objParse(J),this.pausePanelBtn=this.objParse(G),this.pausePanelText=this.objParse(U),this.timer=i,this.node=s,this.canvasContainer=n,this.music=new a,this.opacityState=o,this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){const t=this.pausePanelImg.map((t=>this.loadImage(t.image))),e=this.pausePanelBtn.map((t=>this.loadImage(t.image)));this.initialBtn=yield this.renderImages(e),this.initialImage=yield this.renderImages(t)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.opacityState.show&&this.opacityShow(this.opacityState),this.opacityState.disable&&this.opacityDisable(this.opacityState),this.drawImage(this.initialImage,this.pausePanelImg),this.drawImage(this.initialBtn,this.pausePanelBtn),this.drawText(this.pausePanelText)}moveHundler(t,e,i){this.pausePanelBtn.forEach((s=>{const n=this.scaleCoords(s,e,i);this.determineCoords(t,n)?(this.buttonsHover(s,s.stepY,s.hover),this.changeAnimation(s,!0,this.pausePanelText)):(this.buttonsHover(s,0,0),this.changeAnimation(s,!1,this.pausePanelText))}))}clickHundler(t,e,i,s,n){this.pausePanelBtn.forEach((a=>{const o=this.scaleCoords(a,e,i);if(this.determineCoords(t,o))switch(a.name){case"Продолжить":this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,setTimeout((()=>s.isPaused()),400),this.timer.isRunning=!0;break;case"Главное Меню":this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,setTimeout((()=>s.onMain()),300),setTimeout((()=>cancelAnimationFrame(n)),300),this.music.onStart();break;case"Перезапустить":this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,setTimeout((()=>s.onRestart()),300),setTimeout((()=>cancelAnimationFrame(n)),300),this.music.onMain();break;case"Карта":this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,setTimeout((()=>s.onMap()),300),setTimeout((()=>cancelAnimationFrame(n)),300),this.music.onMain();break;case"Настройки":{let t;this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,this.canvasContainer.node.style.display="none",this.node.childElementCount<2&&(t=new $(this.node),t.node.children[0].classList.add("map")),setTimeout((()=>cancelAnimationFrame(n)),300);break}case"Помощь":this.buttonsClick(a,a.stepY,a.click),this.opacityState.disable=!0,setTimeout((()=>alert("будем делать эту страничку?")),300)}else this.buttonsClick(a,0,0)}))}}const Z=[{type:"picture",name:"start",image:"images/level/panels/goal_start.png",x:446,y:175,width:708,height:850,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"star",image:"images/level/panels/menu_star.png",x:990,y:490,width:60,height:54,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"gold",image:"images/level/panels/goal_gold.png",x:800,y:620,width:160,height:89,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"silver",image:"images/level/panels/goal_silver.png",x:800,y:755,width:160,height:89,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"star",image:"images/level/panels/menu_star.png",x:1010,y:638,width:60,height:54,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"star",image:"images/level/panels/menu_star.png",x:1010,y:772,width:60,height:54,sx:0,sy:0,swidth:0,sheight:0}],Q=[{type:"button",name:"Ок",image:"images/level/panels/startBtn.png",stepY:48,stepX:0,hover:1,click:2,x:690,y:900,width:200,height:77,sx:0,sy:0,swidth:128,sheight:48}],tt=[{text:"Соберите",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:542,y:442,animation:!1},{text:"За прохождение",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:810,y:442,animation:!1},{text:"Цели уровня",fontSize:"62px Vag_Rounded-Bold CY",color:"#fbead0",x:600,y:252,animation:!1},{text:"Лучшее время :",fontSize:"30px Arial",color:"#704f0c",x:676,y:302,animation:!1}],et=[{text:"Ок",fontSize:"32px Vag_Rounded-Bold CY",color:"#fff",x:770,y:944,animation:!1}],it={1:{img:[{type:"button",name:"egg",image:"images/level/initial/egg.png",x:524,y:488,width:60,height:64,sx:0,sy:0,swidth:60,sheight:64}],text:[{name:"eggsCount",text:"4",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:534,animation:!1},{name:"levelEnd",text:"25",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:920,y:534,animation:!1},{name:"goldEnd",text:"+75",fontSize:"46px Vag_Rounded-Bold CY",color:"yellow",x:1026,y:630,animation:!1},{name:"goldTime",text:"01:00",fontSize:"30px Vag_Rounded-Bold CY",color:"yellow",x:842,y:682,animation:!1},{name:"silverEnd",text:"+25",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:1026,y:766,animation:!1},{name:"silverTimer",text:"02:00",fontSize:"30px Vag_Rounded-Bold CY",color:"#fff",x:838,y:816,animation:!1}]},2:{img:[{type:"button",name:"chicken",image:"images/pets/chicken/death.png",x:510,y:552,width:100,height:100,sx:0,sy:0,swidth:64,sheight:64},{type:"button",name:"egg",image:"images/level/initial/egg.png",x:524,y:488,width:60,height:64,sx:0,sy:0,swidth:60,sheight:64}],text:[{name:"eggsCount",text:"6",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:534,animation:!1},{name:"chickenCount",text:"3",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:628,animation:!1},{name:"levelEnd",text:"40",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:920,y:534,animation:!1},{name:"goldEnd",text:"+120",fontSize:"46px Vag_Rounded-Bold CY",color:"yellow",x:1008,y:630,animation:!1},{name:"goldTime",text:"01:30",fontSize:"30px Vag_Rounded-Bold CY",color:"yellow",x:842,y:682,animation:!1},{name:"silverEnd",text:"+40",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:1026,y:766,animation:!1},{name:"silverTimer",text:"02:40",fontSize:"30px Vag_Rounded-Bold CY",color:"#fff",x:838,y:816,animation:!1}]},3:{img:[{type:"button",name:"chicken",image:"images/pets/chicken/death.png",x:510,y:552,width:100,height:100,sx:0,sy:0,swidth:64,sheight:64},{type:"button",name:"egg",image:"images/level/initial/egg.png",x:524,y:488,width:60,height:64,sx:0,sy:0,swidth:60,sheight:64},{type:"button",name:"flour",image:"images/level/initial/flour.png",x:520,y:656,width:80,height:96,sx:0,sy:0,swidth:80,sheight:96}],text:[{name:"eggsCount",text:"6",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:534,animation:!1},{name:"chickenCount",text:"3",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:628,animation:!1},{name:"flourCount",text:"2",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:656,y:722,animation:!1},{name:"levelEnd",text:"50",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:920,y:534,animation:!1},{name:"goldEnd",text:"+150",fontSize:"46px Vag_Rounded-Bold CY",color:"yellow",x:1008,y:630,animation:!1},{name:"goldTime",text:"02:00",fontSize:"30px Vag_Rounded-Bold CY",color:"yellow",x:842,y:682,animation:!1},{name:"silverEnd",text:"+50",fontSize:"46px Vag_Rounded-Bold CY",color:"#fff",x:1026,y:766,animation:!1},{name:"silverTimer",text:"03:00",fontSize:"30px Vag_Rounded-Bold CY",color:"#fff",x:838,y:816,animation:!1}]}};class st extends l{constructor(t,e,i){super(t,e),this.initialImage=[],this.initialBtn=[],this.startImg=[],this.startPanelImg=this.objParse(Z),this.startPanelBtn=this.objParse(Q),this.startPanelStaticText=this.objParse(tt),this.startPanelText=this.objParse(et),this.level=i.toString(),this.levelInitial=JSON.parse(JSON.stringify(it)),this.opacityState={show:!0,disable:!1,opacity:0},this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){const t=this.levelInitial[this.level].img.map((t=>this.loadImage(t.image))),e=this.startPanelImg.map((t=>this.loadImage(t.image))),i=this.startPanelBtn.map((t=>this.loadImage(t.image)));this.initialBtn=yield this.renderImages(i),this.initialImage=yield this.renderImages(e),this.startImg=yield this.renderImages(t)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.opacityState.show&&this.opacityShow(this.opacityState),this.opacityState.disable&&this.opacityDisable(this.opacityState),this.drawImage(this.initialImage,this.startPanelImg),this.drawImage(this.initialBtn,this.startPanelBtn),this.drawImage(this.startImg,this.levelInitial[this.level].img),this.drawStaticText(this.startPanelStaticText),this.drawText([...this.startPanelText,...this.levelInitial[this.level].text])}drawStaticText(t){t.forEach((t=>{this.context.fillStyle=t.color,this.context.font=t.fontSize,"Цели уровня"===t.text?(this.context.shadowColor="#7f5f30",this.context.shadowBlur=10):(this.context.shadowColor="#222222",this.context.shadowBlur=4),this.context.shadowOffsetX=4,this.context.shadowOffsetY=4,"Лучшее время :"===t.text&&(this.canvasFilters(0),this.context.shadowColor=""),this.context.strokeText(t.text,t.x,t.y),this.context.fillText(t.text,t.x,t.y),this.canvasFilters(0)}))}moveHundler(t,e,i){this.startPanelBtn.forEach((s=>{const n=this.scaleCoords(s,e,i);this.determineCoords(t,n)?(this.buttonsHover(s,s.stepY,s.hover),this.changeAnimation(s,!0,this.startPanelText)):(this.buttonsHover(s,0,0),this.changeAnimation(s,!1,this.startPanelText))}))}clickHundler(t,e,i,s){this.startPanelBtn.forEach((n=>{const a=this.scaleCoords(n,e,i);this.determineCoords(t,a)?"Ок"===n.name&&(this.buttonsClick(n,n.stepY,n.click),this.opacityState.disable=!0,setTimeout((()=>s.isStart()),300)):this.buttonsClick(n,0,0)}))}}const nt={type:"picture",name:"place1",image:"images/level/backs/place1.png",x:170,y:292,width:350,height:200,sx:0,sy:0,swidth:0,sheight:0};class at extends l{constructor(t,e,i){super(t,e),this.initialImg=[],this.initialBtn=[],this.initialAnim=[],this.level=i,this.lvlInterface={btn:JSON.parse(JSON.stringify(E)),anim:JSON.parse(JSON.stringify(H)),text:JSON.parse(JSON.stringify(O)),img:JSON.parse(JSON.stringify(R))},3===this.level&&this.lvlInterface.img.push(nt),this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){const t=this.lvlInterface.img.map((t=>this.loadImage(t.image))),e=this.lvlInterface.btn.map((t=>this.loadImage(t.image))),i=this.lvlInterface.anim.map((t=>this.loadImage(t.image)));this.initialBtn=yield this.renderImages(e),this.initialImg=yield this.renderImages(t),this.initialAnim=yield this.renderImages(i)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(this.initialImg,this.lvlInterface.img),this.drawImage(this.initialBtn,this.lvlInterface.btn),this.drawImage(this.initialAnim,this.lvlInterface.anim),this.drawText(this.lvlInterface.text)}getData(){return this.lvlInterface}}class ot extends l{constructor(t,e){super(t,e)}buildSpawn(t,e){t.name===e.name&&t.maxY>e.y&&(e.y+=t.speed)}fullhouseIndicator(t,e,i){const s=t.find((t=>"houseIndicator"===t.name));let n=0,a=!1;const o=setInterval((()=>{s.frameY&&!a&&(n<s.frameY?(s.sy+=s.stepY,n++):a=!0)}),i);setTimeout((()=>{clearInterval(o),s.sy=0}),e)}buildAnimation(t,e,i,s){let n=0,a=0;const o=setInterval((()=>{n<i?(t.sy+=t.sheight,n++):a<e?(a++,n=0,t.sy=0,t.sx+=t.swidth):(n=0,t.sy=0,a=0,t.sx=0)}),50);setTimeout((()=>{clearInterval(o),t.sy=0,t.sx=0,s()}),16e3)}checkProduct(t,e){return 0!==e[t]}deleteProduct(t,e){return t.pop(),[e.pop().name]}deleteUseProduct(t,e){e[t]--}productGhost(t){t.opacity<=1&&t.opacity>.5&&t.active?t.opacity-=.02:(t.active=!1,t.opacity+=.02,t.opacity>=1&&(t.active=!0)),this.context.globalAlpha=t.opacity}}const ht=[{type:"button",name:"storage",image:"images/level/builds/storage/storage_1.png",x:640,y:-300,stepY:132,stepX:0,hover:1,click:2,width:300,height:240,sx:0,sy:0,swidth:164,sheight:132},{type:"animation",name:"car",image:"images/level/car/car-1.png",x:400,y:-210,width:200,height:192,stepY:106,stepX:0,hover:1,click:2,sx:0,sy:0,swidth:110,sheight:106},{type:"button",name:"well",image:"images/level/builds/well/house_well_step_1.png",frameY:16,stepY:100,stepX:0,hover:1,click:2,x:720,y:-200,width:230,height:180,sx:0,sy:0,swidth:128,sheight:100},{type:"animation",name:"waterIndicator",image:"images/level/indicators/indicator_water.png",x:930,y:-200,width:22,stepY:52,stepX:0,hover:1,click:2,height:100,frameY:27,sx:0,sy:0,swidth:12,sheight:52}],rt=[{type:"button",name:"flourBuild",image:"images/level/builds/driedEgg/flour-1.png",x:206,y:-300,stepY:156,stepX:176,hover:1,click:2,width:280,height:248,sx:0,sy:0,swidth:176,sheight:156},{type:"animation",name:"houseIndicator",image:"images/level/builds/driedEgg/houseIndicator.png",x:470,y:-100,width:22,height:100,stepY:52,stepX:0,hover:1,click:2,frameY:27,sx:0,sy:0,swidth:12,sheight:53}],ct=[{name:"flourBuild",maxX:0,maxY:235,speed:24},{name:"houseIndicator",maxX:0,maxY:330,speed:24}];class dt{constructor(t,e){this.animbtnOptions=t,this.waterCount=0,this.maxCount=5,this.showPrice=e}wellAnimation(t){if(this.waterCount>=this.maxCount){let e=0;const i=setInterval((()=>{t.frameY&&(e<t.frameY-1?(t.sy+=t.stepY,e++):(e=0,t.sy=0))}),50);setTimeout((()=>{clearInterval(i),t.sy=0,this.waterCount=0}),2400)}}activeWell(){this.waterCount>=this.maxCount&&(X.wellDisable=!0,this.showPrice.well=!0)}waterIndicatorChange(t){if(this.waterCount<this.maxCount){this.waterCount++,this.activeWell();const e=this.animbtnOptions.find((t=>"waterIndicator"===t.name)),i=e.sheight*e.frameY,s=5;e.sy<i?e.sy+=s*e.stepY:e.sy=0,t.grace=!0}else t.grace=!1}fullWaterIndicator(){if(this.waterCount>=this.maxCount){const t=this.animbtnOptions.find((t=>"waterIndicator"===t.name));let e=0;const i=setInterval((()=>{t.frameY&&(e<t.frameY-1?(t.sy-=t.stepY,e++):(e=0,t.sy=0))}),100);setTimeout((()=>{clearInterval(i),t.sy=0}),2400)}}}var lt=function(t,e,i,s){return new(i||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}))};class gt extends ot{constructor(t,e,i,s){super(t,e),this.build=this.objParse(ct),this.btn=this.objParse(rt),this.productCounter=s,this.func=i,this.initialBtn=[],this.flour={type:"button",name:"flour",image:"images/level/initial/flour.png",x:510,y:326,width:80,height:96,hover:1,click:2,stepY:96,stepX:0,sx:0,sy:0,swidth:80,sheight:96},this.flourProducts=[],this.initialFlour=[],this.maxFrameY=7,this.maxFrameX=1,this.houseDisable=!1,this.animTime=16e3,this.animSpeed=600,this.useProduct="egg",this.opacityState={active:!0,opacity:1},this.animationProduct=!1,this.productOpacity=5e3,this.productWait=9e3,this.startPanel()}startPanel(){return lt(this,void 0,void 0,(function*(){const t=this.btn.map((t=>this.loadImage(t.image)));this.initialBtn=yield this.renderImages(t)}))}render(){this.drawImage(this.initialBtn,this.btn),this.animationProduct&&this.productGhost(this.opacityState),this.drawImage(this.initialFlour,this.flourProducts),this.context.globalAlpha=1,this.startSpawn()}startSpawn(){this.build.forEach((t=>{this.btn.forEach((e=>{this.buildSpawn(t,e)}))}))}clickHundler(t,e,i){[...this.btn,...this.flourProducts].forEach((s=>{const n=this.scaleCoords(s,e,i);if(this.determineCoords(t,n))switch(s.name){case"flourBuild":!this.houseDisable&&this.checkProduct(this.useProduct,this.productCounter)&&(this.houseDisable=!0,this.deleteUseProduct(this.useProduct,this.productCounter),this.func.reRenderStorage(),this.buildAnimation(s,this.maxFrameX,this.maxFrameY,(()=>{this.showProduct(),this.houseDisable=!1})),this.fullhouseIndicator(this.btn,this.animTime,this.animSpeed));break;case"flour":{this.opacityState.active=!1;const t=this.deleteProduct(this.initialFlour,this.flourProducts);this.func.productToStorage(t);break}}}))}moveHundler(t,e,i){this.flourProducts.forEach((s=>{const n=this.scaleCoords(s,e,i);this.determineCoords(t,n)?"flour"===s.name&&this.buttonsHover(s,s.stepY,s.hover):"flour"===s.name&&this.buttonsHover(s,0,0)}))}showProduct(){this.flourProducts.push(this.flour),this.drawProduct(),setTimeout((()=>this.trackingProducts()),this.productWait)}trackingProducts(){this.animationProduct=!0,setTimeout((()=>{this.deleteProduct(this.initialFlour,this.flourProducts),this.animationProduct=!1}),this.productOpacity)}drawProduct(){return lt(this,void 0,void 0,(function*(){const t=this.flourProducts.map((t=>this.loadImage(t.image)));this.initialFlour=yield this.renderImages(t)}))}}var mt=function(t,e,i,s){return new(i||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}))};class ut extends l{constructor(t,e){super(t,e),this.maxFrame=7,this.animDisable=!1,this.animUpDisable=!1,this.arrowUp={type:"animation",name:"up",image:"images/level/effects/arrowUp.png",x:940,y:100,width:90,height:90,sx:0,sy:0,swidth:52,sheight:52},this.arrowRight={type:"animation",name:"right",image:"images/level/effects/arrowRight.png",x:700,y:90,width:90,height:90,sx:0,sy:0,swidth:52,sheight:52},this.arrow=[],this.initialArrow=[],this.startArrow()}startArrow(){return mt(this,void 0,void 0,(function*(){const t=this.arrow.map((t=>this.loadImage(t.image)));this.initialArrow=yield this.renderImages(t)}))}showArrow(t){return mt(this,void 0,void 0,(function*(){"right"===t&&(this.arrow.push(this.arrowRight),this.drawProduct(),this.arrowRightAnim()),"up"===t&&(this.arrow.push(this.arrowUp),this.drawProduct(),this.arrowUpAnim())}))}drawProduct(){return mt(this,void 0,void 0,(function*(){const t=this.arrow.map((t=>this.loadImage(t.image)));this.initialArrow=yield this.renderImages(t)}))}arrowRightAnim(){if(!this.animDisable){this.animDisable=!0;let t=0;const e=this.arrow.find((t=>"right"===t.name)),i=setInterval((()=>{t<this.maxFrame?(e.sx+=e.sheight,t++):(t=0,e.sx=0)}),60);setTimeout((()=>{clearInterval(i),this.animDisable=!1,e.sx=0,this.animEnd()}),1200)}}arrowUpAnim(){if(!this.animUpDisable){this.animUpDisable=!0;let t=0;const e=this.arrow.find((t=>"up"===t.name)),i=setInterval((()=>{t<this.maxFrame?(e.sy+=e.swidth,t++):(t=0,e.sy=0)}),60);setTimeout((()=>{clearInterval(i),this.animUpDisable=!1,e.sy=0,this.animEnd()}),1200)}}render(){this.drawImage(this.initialArrow,this.arrow)}animEnd(){this.arrow=[],this.initialArrow=[]}}class pt extends l{constructor(t,e){super(t,e),this.coin=[{type:"picture",name:"coin",image:"images/level/builds/storage/coin.png",x:916,y:170,width:35,height:35,sx:0,sy:0,swidth:28,sheight:28}],this.coinText=[{text:"19",fontSize:"32px Vag_Rounded-Bold CY",color:"#fff",x:955,y:195,animation:!1}],this.coinData=[],this.initialCoin=[],this.startPrice()}startPrice(){return t=this,e=void 0,s=function*(){const t=this.coin.map((t=>this.loadImage(t.image)));this.initialCoin=yield this.renderImages(t)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(this.initialCoin,this.coin),this.drawText(this.coinText)}}class xt extends ot{constructor(t,e,i,s,n,a,o){super(t,e),this.func=s,this.build=this.objParse(z),this.btn=this.objParse(ht),this.initialBtn=[],this.initialImg=[],this.showPrice={well:!1},this.well=new dt(this.btn,this.showPrice),this.panelState=i,this.products=n,this.opacityState=a,this.level=o,this.driedEgg=new gt(t,e,this.func,this.products),this.arrow=new ut(t,e),this.wellPrice=new pt(t,e),this.price={well:19,chicken:100},this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){const t=this.btn.map((t=>this.loadImage(t.image)));this.initialBtn=yield this.renderImages(t)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(this.initialBtn,this.btn),this.arrow.render(),this.showPrice.well&&this.wellPrice.render(),3===this.level&&this.driedEgg.render(),this.startSpawn()}startSpawn(){this.build.forEach((t=>{this.btn.forEach((e=>{this.buildSpawn(t,e)}))}))}clickHundler(t,e,i){this.btn.forEach((s=>{const n=this.scaleCoords(s,e,i);if(this.determineCoords(t,n))switch(s.name){case"well":X.wellDisable&&X.btnDisable.well?(X.changeTotalMinus(s.name),this.well.wellAnimation(s),this.well.fullWaterIndicator(),X.wellDisable=!1,this.showPrice.well=!1):X.btnDisable.well||this.arrow.showArrow("up");break;case"storage":case"car":this.panelState.carAnimationOn||(this.opacityState.show=!0,this.opacityState.disable=!1,setTimeout((()=>this.func.renderStorage(this.products)),300),this.panelState.storagePanelSwitch=!0)}})),this.driedEgg.clickHundler(t,e,i)}waterChange(t){this.well.waterIndicatorChange(t)}moveHundler(t,e,i){this.btn.forEach((s=>{const n=this.scaleCoords(s,e,i);if(this.determineCoords(t,n))switch(s.name){case"well":break;case"storage":case"car":this.buttonsHover(s,s.stepY,s.hover)}else switch(s.name){case"storage":case"car":this.buttonsHover(s,0,0)}})),this.driedEgg.moveHundler(t,e,i)}}class wt extends l{constructor(t,e,i){super(t,e),this.level=i.toString(),this.levelTotal={1:"10000",2:"90",3:"190"},this.startTotal()}startTotal(){X.totalText.text=this.levelTotal[this.level]}render(){this.drawText([X.totalText])}}var ft=function(t,e,i,s){return new(i||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}))};class yt extends l{constructor(t,e,i,s){super(t,e),this.productsCounter=s,this.initialProducts=[],this.goods=[],this.progress=i,this.storageHeight=5,this.maxColumn=6,this.columnCount=0,this.changeColumn=1,this.sizeUp=23,this.sizeRight=23,this.startX=725,this.startY=1090,this.product=[],this.productRender=[],this.updateProduct()}startStorage(){return ft(this,void 0,void 0,(function*(){const t=this.productRender.map((t=>this.loadImage(t.image)));this.initialProducts=yield this.renderImages(t),yield this.render()}))}updateProduct(){this.product=[{type:"picture",name:"egg",image:"images/level/products_mini/mini_egg.png",x:this.startX,y:this.startY,width:23,height:23,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"bear-1",image:"images/level/products_mini/mini_bear1.png",x:this.startX,y:this.startY,width:23,height:23,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"flour",image:"images/level/products_mini/mini_flour.png",x:this.startX,y:this.startY,width:23,height:23,sx:0,sy:0,swidth:0,sheight:0}]}render(){return ft(this,void 0,void 0,(function*(){this.context.restore(),this.context.globalAlpha=1,this.drawImage(this.initialProducts,this.productRender)}))}changeCoords(){this.changeColumn%this.storageHeight?(this.startY-=this.sizeUp,this.changeColumn++):(this.startX+=this.sizeRight,this.startY=1090,this.changeColumn=1,this.columnCount++)}add(t){console.log(t),this.columnCount<this.maxColumn?(this.goods=t,this.goods.forEach((t=>{this.product.forEach((e=>{e.name===t&&(console.log(t,e.name),this.productRender.push(e),this.changeCoords(),this.updateProduct(),this.productsCounter[t]++,this.progress.scoreCheck(t))}))})),this.startStorage()):alert("склад переполнен")}reRenderStorage(){this.productRender=[],this.initialProducts=[],this.startX=725,this.startY=1090,this.changeColumn=1,this.columnCount=0,this.updateProduct(),Object.entries(this.productsCounter).forEach((t=>{const[e,i]=t;for(let t=0;t<i;t++)this.product.forEach((t=>{t.name===e&&(this.productRender.push(t),this.changeCoords(),this.updateProduct())}))})),this.startStorage()}saveproductsCounter(t){this.productsCounter=t}}const vt=[{type:"picture",name:"one",image:"images/level/panels/goal_done.png",x:1354,y:1106,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"two",image:"images/level/panels/goal_done.png",x:1416,y:1106,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"free",image:"images/level/panels/goal_done.png",x:1478,y:1106,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"four",image:"images/level/panels/goal_done.png",x:1540,y:1106,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0}],bt={1:{img:[{type:"button",name:"egg",image:"images/level/initial/egg.png",x:1346,y:1058,width:44,height:48,sx:0,sy:0,swidth:60,sheight:64}],text:[{name:"egg",text:"0/4",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1350,y:1130,animation:!1,id:0}]},2:{img:[{type:"button",name:"egg",image:"images/level/initial/egg.png",x:1346,y:1058,width:44,height:48,sx:0,sy:0,swidth:60,sheight:64},{type:"button",name:"egg",image:"images/level/initial/chicken.png",x:1406,y:1052,width:60,height:64,sx:0,sy:0,swidth:60,sheight:64}],text:[{name:"egg",text:"0/6",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1350,y:1130,animation:!1,id:0},{name:"chicken",text:"0/3",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1420,y:1130,animation:!1,id:1}]},3:{img:[{type:"button",name:"egg",image:"images/level/initial/egg.png",x:1346,y:1058,width:44,height:48,sx:0,sy:0,swidth:60,sheight:64},{type:"button",name:"egg",image:"images/level/initial/chicken.png",x:1406,y:1052,width:60,height:64,sx:0,sy:0,swidth:60,sheight:64},{type:"button",name:"flour",image:"images/level/initial/flour.png",x:1475,y:1056,width:44,height:55,sx:0,sy:0,swidth:80,sheight:96}],text:[{name:"egg",text:"0/6",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1350,y:1130,animation:!1,id:0},{name:"chicken",text:"0/3",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1420,y:1130,animation:!1,id:1},{name:"flour",text:"0/2",fontSize:"22px Vag_Rounded-Bold CY",color:"#fff",x:1480,y:1130,animation:!1,id:2}]}};class St extends l{constructor(t,e,i){super(t,e),this.levelInitial=JSON.parse(JSON.stringify(bt)),this.startImg=[],this.startDone=[],this.done=JSON.parse(JSON.stringify(vt)),this.level=i.toString(),this.productsScore={},this.levelInitial[this.level].text.forEach((t=>{t.name&&(this.productsScore[t.name]={current:0,max:Number(t.text.slice(-1))})})),this.goals=Object.getOwnPropertyNames(this.productsScore).length,this.goalsDone=new Set,this.startProgress()}startProgress(){return t=this,e=void 0,s=function*(){const t=this.levelInitial[this.level].img.map((t=>this.loadImage(t.image))),e=this.done.map((t=>this.loadImage(t.image)));this.startImg=yield this.renderImages(t),this.startDone=yield this.renderImages(e)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(this.startImg,this.levelInitial[this.level].img),this.drawImage(this.startDone,this.done),this.drawText(this.levelInitial[this.level].text)}scoreChange(t){if(t.name){const e=Number(t.text[0]);this.productsScore[t.name].current++,e<this.productsScore[t.name].max&&(t.text=`${this.productsScore[t.name].current}/${this.productsScore[t.name].max}`),this.productsScore[t.name].current===this.productsScore[t.name].max&&(this.doneView(t),this.goalsDone.add(t.name))}}endGameCheck(){return this.goalsDone.size===this.goals}doneView(t){t.text="",void 0!==t.id&&(this.done[t.id].height=29,this.done[t.id].width=40)}scoreCheck(t){this.levelInitial[this.level].text.forEach((e=>{e.name===t&&this.scoreChange(e)}))}}class Ct extends l{constructor(t,e,i){super(t,e),this.initialImage=[],this.initialBtn=[],this.startImg=[],this.endPanelImg=C,this.endPanelStaticText=k,this.endPanelBtn=Y,this.endPanelText=_,this.dataText=I,this.timer=i,this.endPanelImg=this.objParse(C),this.endPanelStaticText=this.objParse(k),this.endPanelBtn=this.objParse(Y),this.endPanelText=this.objParse(_),this.opacityState={show:!1,disable:!1,opacity:0},this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){this.opacityState.show&&this.opacityShow(this.opacityState),this.opacityState.disable&&this.opacityDisable(this.opacityState);const t=this.endPanelImg.map((t=>this.loadImage(t.image))),e=this.endPanelBtn.map((t=>this.loadImage(t.image)));this.initialImage=yield this.renderImages(t),this.initialBtn=yield this.renderImages(e)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.timer.isRunning=!1,this.timer.endPanelView(),this.drawImage(this.initialImage,this.endPanelImg),this.drawImage(this.initialBtn,this.endPanelBtn),this.drawStaticText(this.endPanelStaticText),this.drawText(this.endPanelText),this.drawText(this.dataText),this.timer.checkZeroTime()}drawStaticText(t){t.forEach((t=>{this.context.fillStyle=t.color,this.context.font=t.fontSize,"Результаты уровня"===t.text?(this.context.shadowColor="#7f5f30",this.context.shadowBlur=10):(this.context.shadowColor="#222222",this.context.shadowBlur=4),this.context.shadowOffsetX=4,this.context.shadowOffsetY=4,this.context.strokeText(t.text,t.x,t.y),this.context.fillText(t.text,t.x,t.y),this.canvasFilters(0),this.context.shadowColor=""}))}moveHundler(t,e,i){this.endPanelBtn.forEach((s=>{const n=this.scaleCoords(s,e,i);this.determineCoords(t,n)?(this.buttonsHover(s,s.stepY,s.hover),this.changeAnimation(s,!0,this.endPanelText)):(this.buttonsHover(s,0,0),this.changeAnimation(s,!1,this.endPanelText))}))}clickHundler(t,e,i,s){this.endPanelBtn.forEach((n=>{const a=this.scaleCoords(n,e,i);this.determineCoords(t,a)?"Ок"===n.name&&(this.opacityState.disable=!0,this.buttonsClick(n,n.stepY,n.click),setTimeout((()=>s.onMap()),300)):this.buttonsClick(n,0,0)}))}}const kt=[{type:"picture",name:"depotBack",image:"images/level/builds/storage/deportBack.png",x:0,y:0,width:1600,height:1200,sx:0,sy:0,swidth:0,sheight:0},{type:"picture",name:"coin",image:"images/level/builds/storage/coin.png",x:1170,y:990,width:48,height:48,sx:0,sy:0,swidth:28,sheight:28},{type:"picture",name:"car-1",image:"images/level/builds/storage/car-1.png",x:1060,y:505,width:500,height:450,sx:0,sy:0,swidth:0,sheight:0}],Yt=[{type:"button",name:"Ок",image:"images/level/panels/startBtn.png",stepY:48,stepX:0,hover:1,click:2,x:800,y:1080,width:200,height:77,sx:0,sy:144,swidth:128,sheight:48},{type:"button",name:"Отмена",image:"images/level/panels/startBtn.png",stepY:48,stepX:0,hover:1,click:2,x:530,y:1080,width:200,height:77,sx:0,sy:0,swidth:128,sheight:48}],_t={egg:{type:"picture",name:"egg",image:"images/level/builds/storage/egg.png",x:60,y:0,width:65,height:65,sx:0,sy:0,swidth:0,sheight:0},"bear-1":{type:"picture",name:"bear-1",image:"images/level/builds/storage/bear-1.png",x:60,y:0,width:65,height:65,sx:0,sy:0,swidth:0,sheight:0},coin:{type:"picture",name:"coin",image:"images/level/builds/storage/coin.png",x:300,y:0,width:40,height:40,sx:0,sy:0,swidth:0,sheight:0},btn:{type:"button",name:"Ок",image:"images/level/builds/storage/btn.png",stepY:48,stepX:0,hover:1,click:2,x:300,y:0,width:60,height:43,sx:0,sy:0,swidth:40,sheight:28},flour:{type:"picture",name:"flour",image:"images/level/builds/storage/flour.png",x:60,y:0,width:65,height:65,sx:0,sy:0,swidth:0,sheight:0}},It=[{text:"Продукты",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:50,y:190,animation:!1},{text:"Цена",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:240,y:190,animation:!1},{text:"Отгрузить",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:360,y:190,animation:!1},{text:"Отгрузка товара",fontSize:"68px Vag_Rounded-Bold CY",color:"#fbead0",x:560,y:94,animation:!1},{text:"Продукты",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:568,y:190,animation:!1},{text:"Цена",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:758,y:190,animation:!1},{text:"Отгрузить",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:878,y:190,animation:!1},{text:"Животные",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:1084,y:190,animation:!1},{text:"Цена",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:1280,y:190,animation:!1},{text:"Отгрузить",fontSize:"32px Vag_Rounded-Bold CY",color:"#eed940",x:1400,y:190,animation:!1}],Bt=[{text:"Ок",fontSize:"34px Vag_Rounded-Bold CY",color:"#fff",x:876,y:1125,animation:!1},{text:"Отмена",fontSize:"34px Vag_Rounded-Bold CY",color:"#fff",x:570,y:1125,animation:!1},{text:"0",name:"total",fontSize:"40px Vag_Rounded-Bold CY",color:"#fff",x:1320,y:1025,animation:!1}];class Pt extends l{constructor(t,e,i){super(t,e),this.initialBox=[],this.func=i,this.box={},this.boxData={},this.productContainer=[{type:"button",name:"egg",image:"images/level/builds/storage/box/egg.png",stepY:28,stepX:0,hover:1,click:2,x:1208,y:722,width:68,height:59,sx:0,sy:0,swidth:44,sheight:38},{type:"button",name:"bear-1",image:"images/level/builds/storage/box/bear-1.png",stepY:28,stepX:0,hover:1,click:2,x:1288,y:722,width:68,height:59,sx:0,sy:0,swidth:44,sheight:38},{type:"button",name:"bear-1",image:"images/level/builds/storage/box/flour.png",stepY:28,stepX:0,hover:1,click:2,x:1288,y:722,width:68,height:59,sx:0,sy:0,swidth:44,sheight:38}],this.boxCounter={egg:0,"bear-1":0,chicken:0,flour:0},this.startX=1208,this.stepX=80,this.maxProducts=2,this.counter=0,this.startTrunc()}startTrunc(){return t=this,e=void 0,s=function*(){const t=this.productContainer.map((t=>this.loadImage(t.image)));this.initialBox=yield this.renderImages(t)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(Object.values(this.box),Object.values(this.boxData))}getImg(t){let e="";const i=this.initialBox.find((i=>{const s=i.src,n=s.substring(i.src.lastIndexOf("/")+1,s.lastIndexOf("."));return e=n,n===t}));return{name:e,img:i}}drawBox(t,e){if(0===this.boxCounter[t]&&this.counter<this.maxProducts){this.counter++;const{name:e,img:i}=this.getImg(t);if(this.boxData[t]={type:"button",name:`${t}`,image:`images/level/builds/storage/box/${t}.png`,stepY:28,stepX:0,hover:1,click:2,x:this.startX,y:722,width:68,height:59,sx:0,sy:0,swidth:44,sheight:38},!i)throw new Error("box img not found");this.box[t]=i,this.changeBoxPosition(t)}console.log("count:",e),this.boxCounter[t]+=e,console.log(this.counter,"counter")}changeBoxPosition(t){this.startX+=this.stepX}deleteProduct(t){this.startX=1208,delete this.box[t],delete this.boxData[t],this.boxCounter[t]=0}clickHundler(t,e,i){Object.values(this.boxData).forEach((s=>{const n=this.scaleCoords(s,e,i);if(this.determineCoords(t,n))switch(s.name){case"egg":case"bear-1":case"flour":this.func.changeCountBoxProduct(this.boxCounter,s.name),this.func.totalSubstraction(s.name,this.boxCounter[s.name]),this.deleteProduct(s.name),this.counter--}}))}}class Tt extends l{constructor(t,e,i,s,n,a,o){super(t,e),this.isState=s,this.func=n,this.productsCounter=a,this.click={changeCountBoxProduct:(t,e)=>{this.changeCountBoxProduct(t,e)},totalSubstraction:(t,e)=>{this.totalSubstraction(t,e)}},this.carTrunc=new Pt(t,e,this.click),this.productClass=i,this.initialImage=[],this.initialBtn=[],this.startImg=[],this.initialIcon=[],this.iconsText={},this.iconsPrice={},this.iconsBtnText={},this.iconsAllText={},this.checkProduct={},this.storageImg=this.objParse(kt),this.storageStaticText=this.objParse(It),this.storageBtn=this.objParse(Yt),this.storageText=this.objParse(Bt),this.icons=JSON.parse(JSON.stringify(_t)),this.stepY=62,this.startY=210,this.textY=46,this.priceX=120,this.coinX=17,this.price={egg:10,"bear-1":50,chicken:25,flour:30},this.iconImg=new Map,this.iconData={},this.coinData={},this.coinImg={},this.btnImg={},this.btnData={},this.btnAllImg={},this.btnAllData={},this.buttonCondition={ok:!1},this.currentState={},this.currentStateCheck=!0,this.opacityState=o,this.startPanel()}startPanel(){return t=this,e=void 0,s=function*(){const t=this.storageImg.map((t=>this.loadImage(t.image))),e=this.storageBtn.map((t=>this.loadImage(t.image))),i=Object.values(this.icons).map((t=>this.loadImage(t.image)));this.initialImage=yield this.renderImages(t),this.initialBtn=yield this.renderImages(e),this.initialIcon=yield this.renderImages(i)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.opacityState.show&&this.opacityShow(this.opacityState),this.opacityState.disable&&this.opacityDisable(this.opacityState),this.drawImage(this.initialImage,this.storageImg),this.drawImage(this.initialBtn,this.storageBtn),this.drawStaticText(this.storageStaticText),this.drawText(this.storageText),this.drawImage([...this.iconImg.values()],Object.values(this.iconData)),this.drawText(Object.values(this.iconsText)),this.drawText(Object.values(this.iconsPrice)),this.drawImage(Object.values(this.coinImg),Object.values(this.coinData)),this.drawImage(Object.values(this.btnImg),Object.values(this.btnData)),this.drawImage(Object.values(this.btnAllImg),Object.values(this.btnAllData)),this.drawText(Object.values(this.iconsBtnText)),this.drawText(Object.values(this.iconsAllText)),this.carTrunc.render()}drawStaticText(t){t.forEach((t=>{this.context.fillStyle=t.color,this.context.font=t.fontSize,this.context.shadowColor="#222222",this.canvasFilters(4),this.context.strokeText(t.text,t.x,t.y),this.context.fillText(t.text,t.x,t.y),this.canvasFilters(0)}))}renderStorage(t){this.currentStateCheck&&this.saveState(t),this.productsCounter=t,Object.entries(t).forEach((t=>{const[e,i]=t;for(let t=1;t<=i;t++)if(1===t&&void 0===this.checkProduct[e]){const{name:i,img:s}=this.getImg(e);s&&(this.icons[i].y=this.startY,this.iconData[i]=this.icons[i],this.iconImg.set(i,s),this.addText(this.iconsText,e,t,"x",0,this.textY),this.addText(this.iconsPrice,e,this.price[e],"",this.priceX,this.textY),this.drawCoin(e),this.drawBtn(e,this.btnData,"1",0,this.btnImg),this.drawBtn(e,this.btnAllData,"All",75,this.btnAllImg),this.addText(this.iconsBtnText,e,1,"",250,this.textY),this.addText(this.iconsAllText,e,"Все","",307,this.textY),this.changeCoordsUp(),this.checkProduct[e]=!0)}else t>1&&(this.iconsText[e].text=`x ${t}`)}))}changeCoordsUp(){this.startY+=this.stepY}addText(t,e,i,s,n,a){t[e]={text:`${s} ${i}`,fontSize:"32px Vag_Rounded-Bold CY",color:"#fff",x:132+n,y:this.icons[e].y+a,animation:!1}}getImg(t){let e="";const i=this.initialIcon.find((i=>{const s=i.src,n=s.substring(i.src.lastIndexOf("/")+1,s.lastIndexOf("."));return e=n,n===t}));return{name:e,img:i}}drawCoin(t){const{name:e,img:i}=this.getImg("coin");if(this.coinData[t]={type:"picture",name:"coin",image:"images/level/builds/storage/coin.png",x:300,y:this.icons[t].y+this.coinX,width:40,height:40,sx:0,sy:0,swidth:0,sheight:0},!i)throw new Error("coin img not found");this.coinImg[t]=i}drawBtn(t,e,i,s,n){const{name:a,img:o}=this.getImg("btn");if(e[t]={type:"button",name:i,image:"images/level/builds/storage/btn.png",stepY:28,stepX:0,hover:1,click:2,x:360+s,y:this.icons[t].y+12,width:70,height:50,sx:0,sy:0,swidth:40,sheight:28},!o)throw new Error("coin img not found");n[t]=o}clickHundler(t,e,i,s){this.storageBtn.forEach((n=>{const a=this.scaleCoords(n,e,i);if(this.determineCoords(t,a))switch(n.name){case"Ок":this.buttonCondition.ok&&(this.buttonsClick(n,n.stepY,n.click),this.opacityState.disable=!0,this.productClass.reRenderStorage(),setTimeout((()=>s.storagePanelSwitch=!1),300),this.changeTotal("",0),this.isState.carAnimationOn=!0,this.buttonDisable(),this.buttonCondition.ok=!1,this.carTruncClear(),this.currentStateCheck=!0);break;case"Отмена":setTimeout((()=>s.storagePanelSwitch=!1),300),this.buttonsClick(n,n.stepY,n.click),this.opacityState.disable=!0,this.buttonCondition.ok=!1,this.buttonDisable(),this.changeTotal("",0),this.currentStateCheck=!0,this.saveProducts(),this.carTruncClear()}})),[...Object.entries(this.btnData),...Object.entries(this.btnAllData)].forEach((s=>{const[n,a]=s,o=this.scaleCoords(a,e,i);if(this.determineCoords(t,o))switch(a.name){case"1":this.buttonsClick(a,a.stepY,a.click),this.carTrunc.drawBox(n,1),this.productSubstraction(n),this.changeTotal(n,1),this.buttonCondition.ok=!0;break;case"All":this.buttonsClick(a,a.stepY,a.click),this.changeTotal(n,this.productsCounter[n]),this.carTrunc.drawBox(n,this.productsCounter[n]),this.productsCounter[n]=0,this.deleteRow(),this.buttonCondition.ok=!0}})),this.carTrunc.clickHundler(t,e,i)}moveHundler(t,e,i){this.storageBtn.forEach((s=>{const n=this.scaleCoords(s,e,i);if(this.determineCoords(t,n))switch(s.name){case"Ок":this.buttonCondition.ok&&(this.buttonsHover(s,s.stepY,s.hover),this.changeAnimation(s,!0,this.storageText));break;case"Отмена":this.buttonsHover(s,s.stepY,s.hover),this.changeAnimation(s,!0,this.storageText)}else"Ок"===s.name?this.buttonCondition.ok&&(this.buttonsHover(s,s.stepY,0),this.changeAnimation(s,!1,this.storageText)):(this.buttonsHover(s,0,0),this.changeAnimation(s,!1,this.storageText))})),[...Object.entries(this.btnData),...Object.entries(this.btnAllData)].forEach((s=>{const[n,a]=s,o=this.scaleCoords(a,e,i);if(this.determineCoords(t,o))switch(a.name){case"1":case"All":this.buttonsHover(a,a.stepY,a.hover)}else this.buttonsHover(a,0,0)}))}productSubstraction(t){const e=this.productsCounter[t]-=1;e>0?this.iconsText[t].text=`x ${e}`:0===e&&this.deleteRow()}deleteRow(){this.startY=210,this.iconsText={},this.iconsPrice={},this.iconsBtnText={},this.iconsAllText={},this.coinData={},this.coinImg={},this.btnData={},this.btnImg={},this.btnAllImg={},this.btnAllData={},this.iconImg=new Map,this.iconData={},this.checkProduct={},this.renderStorage(this.productsCounter)}changeTotal(t,e){this.storageText.forEach((i=>{if("total"===i.name)if(0===e)this.func.addStorageTotal(i.text),i.text=`${e}`;else{const s=+i.text+this.price[t]*e;i.text=`${s}`}}))}totalSubstraction(t,e){this.storageText.forEach((i=>{if("total"===i.name){const s=+i.text-this.price[t]*e;i.text=`${s}`,0===s&&(this.buttonCondition.ok=!1,this.buttonDisable())}}))}buttonDisable(){this.storageBtn.forEach((t=>{"Ок"===t.name&&(t.sy=3*t.stepY)}))}saveState(t){this.currentState=JSON.parse(JSON.stringify(t)),this.currentStateCheck=!1}saveProducts(){for(const t in this.productsCounter)this.productsCounter[t]=this.currentState[t]}changeCountBoxProduct(t,e){this.productsCounter[e]+=t[e],this.currentStateCheck=!1,this.renderStorage(this.productsCounter)}carTruncClear(){this.carTrunc.boxCounter={egg:0,"bear-1":0,chicken:0,flour:0},this.carTrunc.box={},this.carTrunc.boxData={},this.carTrunc.counter=0,this.carTrunc.startX=1208}}class Mt extends l{constructor(t,e,i){super(t,e),this.isState=i,this.total=0,this.initialL=[],this.initialR=[],this.initialM=[],this.maxRight=1490,this.textRight=1470,this.maxLeft=1258,this.mapRight=1414,this.mapLeft=1182,this.carRight={type:"picture",name:"carRight",image:"images/level/car/car-right.png",x:1258,y:86,width:80,height:68,sx:0,sy:0,swidth:0,sheight:0},this.carLeft={type:"picture",name:"carLeft",image:"images/level/car/car-left.png",x:1490,y:86,width:0,height:0,sx:0,sy:0,swidth:0,sheight:0},this.minimap={type:"picture",name:"minimap",image:"images/level/car/minimap.png",x:1182,y:140,width:120,height:40,sx:0,sy:0,swidth:0,sheight:0},this.text={text:"0",fontSize:"24px Vag_Rounded-Bold CY",color:"#000",x:1238,y:168,animation:!1},this.carCondition=!1,this.startCar()}startCar(){return t=this,e=void 0,s=function*(){const t=[this.carRight].map((t=>this.loadImage(t.image))),e=[this.carLeft].map((t=>this.loadImage(t.image))),i=[this.minimap].map((t=>this.loadImage(t.image)));this.initialR=yield this.renderImages(t),this.initialL=yield this.renderImages(e),this.initialM=yield this.renderImages(i)},new((i=void 0)||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}));var t,e,i,s}render(){this.drawImage(this.initialR,[this.carRight]),this.drawImage(this.initialL,[this.carLeft]),this.drawImage(this.initialM,[this.minimap]),this.drawText([this.text]),this.carCondition||this.carRightAnimation(),this.carCondition&&this.carLeftAnimation()}carRightAnimation(){this.carRight.x<this.maxRight&&this.minimap.x<this.mapRight?(this.carRight.x+=.5,this.minimap.x+=.5,this.text.x+=.5):(this.carRight.width=0,this.carRight.height=0,this.carRight.x=this.maxLeft,this.carCondition=!0)}carLeftAnimation(){this.carLeft.x>this.maxLeft&&this.minimap.x>this.mapLeft?(this.carLeft.x-=.5,this.minimap.x-=.5,this.text.x-=.5,this.carLeft.width=80,this.carLeft.height=68):(this.carLeft.width=0,this.carLeft.height=0,this.carRight.width=80,this.carRight.height=68,this.carLeft.x=this.maxRight,this.carCondition=!1,this.isState.carAnimationOn=!1,X.changeTotalPlus(this.total))}addStorageTotal(t){this.text.text=t,this.total=+t}}var Xt=function(t,e,i,s){return new(i||(i=Promise))((function(n,a){function o(t){try{r(s.next(t))}catch(t){a(t)}}function h(t){try{r(s.throw(t))}catch(t){a(t)}}function r(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,h)}r((s=s.apply(t,e||[])).next())}))};class At extends t{constructor(e,i,s,n){super(e,i,s),this.level=n;const a=new t(this.node,"div","canvas__container","");this.canvas=new t(a.node,"canvas","canvas",""),this.canvas.node.width=1600,this.canvas.node.height=1200,this.curWidthK=1,this.curHeightK=1,this.animation=0,this.isGrace={grace:!0},this.storageProducts=[],this.panelState={pausePanelSwitch:!1,startPanelSwitch:!0,endPanelSwitch:!1,storagePanelSwitch:!1,carAnimationOn:!1},this.productsCounter={egg:0,chicken:0,"bear-1":0,flour:0},this.opacityState={show:!1,disable:!1,opacity:0},this.click={isPaused:()=>this.panelState.pausePanelSwitch=!1,onMain:()=>this.onMain(),onRestart:()=>this.onRestart(),onSettings:()=>this.onSettings(),onMap:()=>this.onMap(),isStart:()=>this.panelState.startPanelSwitch=!1,renderStorage:t=>this.storage.renderStorage(t),addStorageTotal:t=>this.car.addStorageTotal(t),productToStorage:t=>this.products.add(t),reRenderStorage:()=>this.products.reRenderStorage()},this.context=this.canvas.node.getContext("2d"),this.commonFunction=new l(this.canvas.node,this.context),this.levelInterface=new at(this.canvas.node,this.context,this.level),this.startPanel=new st(this.canvas.node,this.context,this.level),this.timer=new A(this.canvas.node,this.context,this.level),this.levelRender=new j(this.canvas.node,this.context),this.total=new wt(this.canvas.node,this.context,this.level),this.pausePanel=new q(this.canvas.node,this.context,this.timer,this.node,a,this.opacityState),this.buildSpawn=new xt(this.canvas.node,this.context,this.panelState,this.click,this.productsCounter,this.opacityState,this.level),this.progress=new St(this.canvas.node,this.context,this.level),this.products=new yt(this.canvas.node,this.context,this.progress,this.productsCounter),this.endPanel=new Ct(this.canvas.node,this.context,this.timer),this.storage=new Tt(this.canvas.node,this.context,this.products,this.panelState,this.click,this.productsCounter,this.opacityState),this.car=new Mt(this.canvas.node,this.context,this.panelState),this.arrow=new ut(this.canvas.node,this.context);const{btn:o,anim:h,text:r}=this.levelInterface.getData();this.btn=o,this.coin=new S(h),X.checkDisable(),this.startUI(),this.levelRender.startLevel(),window.onresize=()=>{const t=this.commonFunction.canvasScale();this.curWidthK=t.curWidthK,this.curHeightK=t.curHeightK},this.canvas.node.addEventListener("mousemove",(t=>{this.canvasMoveHundler(t,[...o,...h],r)})),this.canvas.node.addEventListener("click",(t=>{this.canvasClickHundler(t,[...o,...h])}))}startUI(){return Xt(this,void 0,void 0,(function*(){const t=this.commonFunction.canvasScale();this.curWidthK=t.curWidthK,this.curHeightK=t.curHeightK,this.run()}))}run(){return Xt(this,void 0,void 0,(function*(){this.context.restore(),this.context.globalAlpha=1,this.render(),!0===this.panelState.pausePanelSwitch&&this.pausePanel.render(),this.animation=requestAnimationFrame((()=>{this.run()}))}))}render(){this.context.clearRect(0,0,this.canvas.node.width,this.canvas.node.height),this.levelInterface.render(),this.total.render(),this.panelState.startPanelSwitch?this.startPanel.render():(this.coin.coinAnimation(),this.timer.drawText(),this.levelRender.renderLevel(this.curWidthK,this.curHeightK,this.panelState.pausePanelSwitch),this.buildSpawn.render(),this.products.render(),this.progress.render(),this.arrow.render(),this.panelState.carAnimationOn&&this.car.render(),this.panelState.storagePanelSwitch?this.storage.render():(this.endGameCheck(),this.panelState.endPanelSwitch&&this.endPanel.render()))}endGameCheck(){this.panelState.endPanelSwitch=this.progress.endGameCheck()}canvasMoveHundler(t,e,i){this.levelRender.moveHundler(t,this.curWidthK,this.curHeightK),this.panelState.pausePanelSwitch?this.pausePanel.moveHundler(t,this.curWidthK,this.curHeightK):this.panelState.startPanelSwitch?this.startPanel.moveHundler(t,this.curWidthK,this.curHeightK):this.panelState.endPanelSwitch?this.endPanel.moveHundler(t,this.curWidthK,this.curHeightK):this.panelState.storagePanelSwitch?this.storage.moveHundler(t,this.curWidthK,this.curHeightK):(this.buildSpawn.moveHundler(t,this.curWidthK,this.curHeightK),e.forEach((e=>{const s=this.commonFunction.scaleCoords(e,this.curWidthK,this.curHeightK);if(this.commonFunction.determineCoords(t,s))switch(e.name){case"pig":case"chicken":X.btnDisable[e.name]?this.commonFunction.buttonsHover(e,e.stepY,e.hover):this.commonFunction.btnDisable(e,e.stepY);break;case"Меню":case"levelPanel":this.commonFunction.buttonsHover(e,e.stepY,e.hover),this.commonFunction.changeAnimation(e,!0,i)}else switch(e.name){case"pig":case"chicken":X.btnDisable[e.name]?this.commonFunction.buttonsHover(e,0,0):this.commonFunction.btnDisable(e,e.stepY);break;case"Меню":case"levelPanel":this.commonFunction.buttonsHover(e,0,0),this.commonFunction.changeAnimation(e,!1,i)}})))}canvasClickHundler(t,e){this.panelState.pausePanelSwitch?this.pausePanel.clickHundler(t,this.curWidthK,this.curHeightK,this.click,this.animation):this.panelState.startPanelSwitch?this.startPanel.clickHundler(t,this.curWidthK,this.curHeightK,this.click):this.panelState.endPanelSwitch?this.endPanel.clickHundler(t,this.curWidthK,this.curHeightK,this.click):this.panelState.storagePanelSwitch?this.storage.clickHundler(t,this.curWidthK,this.curHeightK,this.panelState):(this.storageProducts=[...this.levelRender.clickHundler(t,this.curWidthK,this.curHeightK)],0===this.storageProducts.length?(this.buildSpawn.clickHundler(t,this.curWidthK,this.curHeightK),e.forEach((e=>{const i=this.commonFunction.scaleCoords(e,this.curWidthK,this.curHeightK);if(this.commonFunction.determineCoords(t,i))switch(e.name){case"Меню":this.commonFunction.buttonsClick(e,e.stepY,e.click),this.opacityState.show=!0,this.opacityState.disable=!1,this.panelState.pausePanelSwitch=!0,this.timer.isRunning=!1,setTimeout((()=>this.startBtn(e)),300);break;case"chicken":X.btnDisable[e.name]?(this.levelRender.createAnimal("chicken"),X.changeTotalMinus(e.name),this.commonFunction.buttonsClick(e,e.stepY,e.click),setTimeout((()=>this.startBtn(e)),200)):this.arrow.showArrow("up");break;case"pig":X.btnDisable[e.name]?(this.levelRender.createAnimal("bear"),X.changeTotalMinus(e.name),this.commonFunction.buttonsClick(e,e.stepY,e.click),setTimeout((()=>this.startBtn(e)),200)):this.arrow.showArrow("up");break;case"mainArea":{const e=this.canvas.node.getBoundingClientRect(),i=(t.clientX-e.left)*this.curWidthK,s=(t.clientY-e.top)*this.curHeightK;this.buildSpawn.waterChange(this.isGrace),this.isGrace.grace?this.levelRender.createGrass(i,s,this.curWidthK,this.curHeightK):this.arrow.showArrow("right");break}}}))):this.products.add(this.storageProducts))}startBtn(t){this.commonFunction.btnActive(t,t.stepY)}onMap(){throw new Error("Method not implemented.")}onMain(){throw new Error("Method not implemented.")}onRestart(){throw new Error("Method not implemented.")}onSettings(){throw new Error("Method not implemented.")}}class Rt extends t{constructor(e){super(e),new t(this.node,"h2","","Награды"),new t(this.node,"button","","ОК").node.onclick=()=>{this.onBack()}}onBack(){throw new Error("Method not implemented.")}}class Et extends t{constructor(i){super(i),this.buttonEffect=new e,this.resizeWindow=()=>{this.wrapper.node.style.width=String(window.innerHeight/600*800)+"px"},this.wrapper=new t(this.node,"div","wrapper author",""),this.resizeWindow(),window.addEventListener("resize",this.resizeWindow),new t(this.wrapper.node,"h2","title author__title","Авторы").node.setAttribute("data-text","Авторы"),new t(this.wrapper.node,"div","author__status","Программисты");const s=new t(this.wrapper.node,"ul","author__list",""),n=(new t(s.node,"li","author__item","Руслан"),new t(s.node,"li","author__item","Яков"),new t(s.node,"li","author__item","Серафим"),new t(this.wrapper.node,"button","btn btn_close","ОК"));this.buttonEffect.devideButton(n.node),n.node.onclick=()=>{this.onBack()}}onBack(){throw new Error("Method not implemented.")}}class Ht{constructor(){this.url="https://farm-frenzy.herokuapp.com/"}login(t,e){return i=this,s=void 0,a=function*(){const i=this.url+"?type=signin&name="+t+"&password="+e;let s={message:"Что-то пошло не так"};try{yield fetch(i,{method:"POST",mode:"no-cors"}).then((t=>(console.log("Begin: ",t),t.json()))).then((t=>{console.log("Convert: ",t),s=t}))}catch(t){console.log("Request error: ",t)}return yield s},new((n=void 0)||(n=Promise))((function(t,e){function o(t){try{r(a.next(t))}catch(t){e(t)}}function h(t){try{r(a.throw(t))}catch(t){e(t)}}function r(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(t){t(i)}))).then(o,h)}r((a=a.apply(i,s||[])).next())}));var i,s,n,a}}class zt extends t{constructor(i){super(i),this.buttonEffect=new e,this.resizeWindow=()=>{this.wrapper.node.style.width=String(window.innerHeight/600*800)+"px"},this.wrapper=new t(this.node,"div","wrapper main",""),this.resizeWindow(),window.addEventListener("resize",this.resizeWindow),this.music=new a,this.backend=new Ht,new t(this.wrapper.node,"img","logo","").node.src="images/main/logo-ru.png";const s=new t(this.wrapper.node,"div","panel panel_login","");new t(s.node,"div","title panel__greet","С возвращением!").node.setAttribute("data-text","С возвращением!");const n=new t(s.node,"input","panel__name","");n.node.type="text",n.node.placeholder="Фермерское имя";const o=new t(s.node,"input","panel__name","");o.node.type="password",o.node.placeholder="Пароль";const h=new t(s.node,"button","btn","Войти");this.buttonEffect.devideButton(h.node);const r=new t(s.node,"div","panel__msg","");h.node.onclick=()=>{const t=n.node.value,e=o.node.value;this.backend.login(t,e).then((t=>{t?(console.log("Final: ",t),r.node.textContent=t.message):r.node.textContent="Что-то пошло не так"}))};const c=new t(this.wrapper.node,"footer","footer",""),d=new t(c.node,"button","btn","Меню");this.buttonEffect.devideButton(d.node),d.node.onclick=()=>{this.onBack()};const l=new t(c.node,"button","btn","Регистрация");this.buttonEffect.devideButton(l.node),l.node.onclick=()=>{throw new Error("Method not implemented.")}}onBack(){throw new Error("Method not implemented.")}}new class extends t{constructor(t,e,i){super(t,e,i),this.mainCycle(),this.music=new a,this.music.start()}mainCycle(){const t=new o(this.node,"div","main__page");t.onSelectMap=()=>{t.destroy(),this.gameMapCycle()},t.onSettings=()=>{t.destroy(),this.settingsCycle()},t.onAwards=()=>{t.destroy(),this.awardsCycle()},t.onAuthors=()=>{t.destroy(),this.authorsCycle()},t.onLogin=()=>{t.destroy(),this.loginCycle()}}gameMapCycle(){const e=new t(this.node,"div","wrapper__map",""),i=new m(e.node,"div","map","");i.onSelectShop=()=>{e.destroy(),i.destroy(),this.shopCycle()},i.startLevel=t=>{e.destroy(),i.destroy(),this.levelCycle(t)},i.onBack=()=>{e.destroy(),i.destroy(),this.mainCycle()}}shopCycle(){const t=new b(this.node);t.gameMapBack=()=>{t.destroy(),this.gameMapCycle()}}levelCycle(e){const i=new t(this.node,"div","wrapper__map level",""),s=new At(i.node,"div","level__page",e);s.onMap=()=>{i.destroy(),s.destroy(),this.gameMapCycle()},s.onMain=()=>{i.destroy(),s.destroy(),this.mainCycle()},s.onRestart=()=>{i.destroy(),s.destroy(),this.levelCycle(1)},s.onSettings=()=>{i.destroy(),s.destroy(),this.settingsCycle()}}settingsCycle(){const t=new $(this.node);t.onBack=()=>{t.destroy(),this.mainCycle()}}awardsCycle(){const t=new Rt(this.node);t.onBack=()=>{t.destroy(),this.mainCycle()}}authorsCycle(){const t=new Et(this.node);t.onBack=()=>{t.destroy(),this.mainCycle()}}loginCycle(){const t=new zt(this.node);t.onBack=()=>{t.destroy(),this.mainCycle()}}}(document.body,"div","farm")})();